#!/usr/bin/env node
var Re=Object.create;var F=Object.defineProperty,Ce=Object.defineProperties,De=Object.getOwnPropertyDescriptor,Fe=Object.getOwnPropertyDescriptors,_e=Object.getOwnPropertyNames,U=Object.getOwnPropertySymbols,Oe=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var N=(t,e,s)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,y=(t,e)=>{for(var s in e||(e={}))J.call(e,s)&&N(t,s,e[s]);if(U)for(var s of U(e))je.call(e,s)&&N(t,s,e[s]);return t},b=(t,e)=>Ce(t,Fe(e)),ke=t=>F(t,"__esModule",{value:!0});var Le=(t,e,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of _e(e))!J.call(t,r)&&r!=="default"&&F(t,r,{get:()=>e[r],enumerable:!(s=De(e,r))||s.enumerable});return t},l=t=>Le(ke(F(t!=null?Re(Oe(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var xe=l(require("sade")),Pe=l(require("esbuild-register/dist/node"));var He="presta",$e="0.46.1",Me="Hyper minimal framework for the modern web.",Te="./index.js",Be="./index.d.ts",Ve={presta:"./bin.js"},ze=["utils","runtime","bin.js","index.js","html.js","serialize.js","bin.d.ts","index.d.ts","core.d.ts","html.d.ts","serialize.d.ts"],qe={build:`node scripts/build && tsc --emitDeclarationOnly && echo '
\u26A1\uFE0E Types generated'`,test:"c8 uvu -r esbuild-register lib/__tests__ -i ^_ && pnpm typecheck && echo '\u26A1\uFE0E Types checked'",cloc:"pnpm dlx cloc './lib/*.ts'",typecheck:"tsc --noEmit"},Ae={type:"git",url:"git+ssh://git@github.com/sure-thing/presta.git"},Ie="estrattonbailey",Qe="MIT",Ue={url:"https://github.com/sure-thing/presta/issues"},Je="https://github.com/sure-thing/presta#readme",Ne={chokidar:"^3.4.3","deep-extend":"^0.6.0",deepmerge:"^4.2.2",dotenv:"^10.0.0",esbuild:"^0.12.28","esbuild-register":"^2.6.0",filewatcher:"^3.0.1","fs-extra":"^9.0.1","get-port":"^5.1.1",kleur:"^4.1.4","lambda-types":"^1.0.0","mime-types":"^2.1.31","module-alias":"^2.2.2",ms:"^2.1.2",picomatch:"^2.3.0","query-string":"^6.14.1","raw-body":"^2.4.1",regexparam:"^1.3.0","route-sort":"^1.0.0",sade:"^1.7.3",sirv:"^1.0.7",smitter:"^1.1.1",statues:"^1.0.0-alpha1",statuses:"^2.0.1","tiny-glob":"^0.2.9","watch-dependency-graph":"^3.0.1",ws:"^8.4.0"},We={"@netlify/functions":"^0.7.2","@types/deep-extend":"^0.4.32","@types/fs-extra":"^9.0.12","@types/mime-types":"^2.1.0","@types/module-alias":"^2.0.1","@types/node":"^18.6.3","@types/picomatch":"^2.2.4","@types/sade":"^1.7.3","@types/statuses":"^2.0.0","@types/ws":"^8.2.2",c8:"^7.11.0",proxyquire:"^2.1.3","supertest-fetch":"^1.4.3",typescript:"^4.5.2",uvu:"^0.5.6"},W={name:He,version:$e,description:Me,main:Te,types:Be,bin:Ve,files:ze,scripts:qe,repository:Ae,author:Ie,license:Qe,bugs:Ue,homepage:Je,dependencies:Ne,devDependencies:We};var le=l(require("http")),ce=l(require("regexparam")),pe=l(require("statuses")),ue=l(require("ws")),d=l(require("path")),de=l(require("get-port")),me=l(require("dotenv")),fe=l(require("module-alias")),c=l(require("fs-extra")),ge=l(require("tiny-glob/sync")),M=l(require("mime-types")),he=l(require("watch-dependency-graph")),T=l(require("chokidar")),ve=l(require("picomatch")),ye=l(require("esbuild")),A=l(require("smitter")),B=l(require("kleur")),be=l(require("route-sort"));function E(t){return delete require.cache[t],require(t)}function x(){let t=process.hrtime();return()=>{let[e,s]=process.hrtime(t),r=s/1e6;return e<1?(r>=1?r.toFixed(0):r.toFixed(2))+"ms":e+"."+r.toFixed(0)+"s"}}function G(t){for(var e=5381,s=t.length;s;)e=e*33^t.charCodeAt(--s);return(e>>>0).toString(36)}var K=l(require("url")),Y=l(require("raw-body")),ee=l(require("mime-types"));var Z=l(require("query-string"));function _(t){let e=(0,Z.parse)(t,{arrayFormat:"comma"}),s={},r={};for(let o of Object.keys(e)){let i=e[o];Array.isArray(i)?r[o]=i:i&&(s[o]=i)}return{queryStringParameters:s,multiValueQueryStringParameters:r}}var Ge=/image|audio|video|application\/pdf|application\/zip|applicaton\/octet-stream/i;function O(t){return Boolean(t)&&Ge.test(t)}function P(t){var i,n;let e=t.rawQuery||t.path.split("?")[1],{queryStringParameters:s,multiValueQueryStringParameters:r}=_(e),o=(n=t.isBase64Encoded)!=null?n:O(((i=t==null?void 0:t.headers)==null?void 0:i["content-type"])||"");return{rawUrl:t.rawUrl||t.path,rawQuery:e,path:t.path,httpMethod:t.httpMethod||"GET",headers:t.headers||{},multiValueHeaders:t.multiValueHeaders||{},queryStringParameters:t.queryStringParameters||s,multiValueQueryStringParameters:t.multiValueQueryStringParameters||r,pathParameters:t.pathParameters||{},body:t.body||null,isBase64Encoded:o!=null?o:!1,requestContext:t.requestContext||{},resource:t.resource||""}}function X(t){let e={},s={};for(let r of Object.keys(t)){let o=r.toLowerCase(),i=t[r];!i||(Array.isArray(i)?s[o]=i:e[o]=i)}return{headers:e,multiValueHeaders:s}}async function te(t){let{url:e="",method:s}=t,{headers:r,multiValueHeaders:o}=X(t.headers),i=O(r["content-type"]||""),a=r["content-length"]?await(0,Y.default)(t,{limit:"1mb",encoding:r["content-type"]&&ee.default.charset(r["content-type"])||!0}):void 0,p=(0,K.parse)(e).query||"",{queryStringParameters:m,multiValueQueryStringParameters:u}=_(p);return P({rawUrl:e,path:e,httpMethod:s,headers:r,multiValueHeaders:o,rawQuery:p,queryStringParameters:m,multiValueQueryStringParameters:u,body:a?Buffer.from(a).toString(i?"base64":"utf8"):null,isBase64Encoded:i,pathParameters:void 0,requestContext:{},resource:""})}var V=l(require("statuses"));function re({statusCode:t}){return`<!-- built with presta https://npm.im/presta -->
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>${t} \u2014\xA0${V.default.message[t]}</title>
        <link rel="icon" type="image/png" href="https://presta.run/favicon.png">
        <link rel="icon" type="image/svg" href="https://presta.run/favicon.svg">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;900&display=swap" rel="stylesheet"> 
        <link rel='stylesheet' href='https://unpkg.com/svbstrate@5.1.0/svbstrate.css' />
        <style>
          html,body {
            font-family: 'Inter', 'sans-serif';
            color: #23283D;
            background-color: #DADEF0;
          }
          #favicon {
            fill: #23283D;
          }
          @media (prefers-color-scheme: dark) {
            html,body {
              color: #DADEF0;
              background-color: #23283D;
            }
            #favicon {
              fill: #DADEF0;
            }
          }
        </style>
      </head>
      <body class='w f aic jcc' style='height: 100vh'>
        <div class='p12 tac'>
          <h1>${t}</h1>
          <p class='mb1'>${V.default.message[t]}</p>

          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#a)">
              <path id="favicon" fill-rule="evenodd" clip-rule="evenodd" d="M10.4 7c-.3 0-.8.2-1 .5L1.1 22.1c-.2.3 0 .6.3.6l4 .3-2.1 2.6c-.2.3-.1.6.2.6l16.8 1.3c.4 0 .8-.2 1-.4L32 13.9c.2-.2.1-.5-.2-.5l-6.4-.5 2.2-4c.2-.3 0-.5-.3-.6L10.4 7ZM24 12.8l1.9-3.4-15.5-1.2-7.7 13.4 3.6.3 7.5-9.4c.3-.3.7-.5 1-.4l9.2.7ZM7.6 22l7.1-8.9 8.7.7-5.2 9L7.6 22Zm-1 1.1 11.6 1c.3 0 .8-.3 1-.6l5.5-9.6 5.5.5-9.7 12L5 25.2l1.7-2Z" fill="#23283D"/>
            </g>
            <defs>
              <clipPath id="a">
                <path fill="#fff" d="M0 0h32v32H0z"/>
              </clipPath>
            </defs>
          </svg>
        </div>
      </body>
    </html>
  `}var se=l(require("regexparam"));function j(t,e){let[s]=t.split("?"),r=(0,se.default)(e),o=0,i={},n=r.pattern.exec(s)||[];for(;o<r.keys.length;)i[r.keys[o]]=n[++o];return i}function k(t,e){if(e.multiValueHeaders)for(let s of Object.keys(e.multiValueHeaders))t.setHeader(s,e.multiValueHeaders[s].map(r=>String(r)));if(e.headers)for(let s of Object.keys(e.headers))t.setHeader(s,String(e.headers[s]));t.statusCode=e.statusCode,t.end(e.body)}function z(t){for(let e of Object.keys(t))t[e.toLowerCase()]=t[e]||"";return t}var L;(function(r){r.Html="text/html; charset=utf-8",r.Json="application/json; charset=utf-8",r.Xml="application/xml; charset=utf-8"})(L||(L={}));function ie(t){return typeof t=="object"?JSON.stringify(t):t}function oe(t,e){let s=e.statusCode||200,r=e.headers?z(e.headers):{};return s>299&&s<399||(r["content-type"]=t),{isBase64Encoded:e.isBase64Encoded||!1,statusCode:s,headers:r,multiValueHeaders:e.multiValueHeaders?z(e.multiValueHeaders):{},body:ie(e.body||"")}}function H(t){return oe(L.Html,t)}function ne(t){return oe(L.Json,b(y({},t),{body:ie(t.body)}))}function $(t){return typeof t=="string"?H({body:t}):b(y({},t),{statusCode:t.statusCode||200})}function ae(t){return async(e,s)=>{let r=P(e);return Object.keys(r.pathParameters||{}).length||(r.pathParameters=j(e.path,t.route)),$(await t.handler(r,s))}}var h;(function(r){r.Dev="dev",r.Build="build",r.Serve="serve"})(h||(h={}));var q=class extends Error{constructor(e,s=500){super(e);this.name="HttpError",this.statusCode=s}};var v="presta.config.js",I="presta.config.ts",Ze="./.presta",Xe="./.presta/functions",Ke="./.presta/static";function Ye({port:t}){return`
    <script>
      (function (global) {
        var socket = new WebSocket('ws://localhost:${t}');

        socket.addEventListener('open', function (event) {
          console.log('[presta] connected on port ${t}')
        });

        socket.addEventListener('message', function (event) {
          console.log(\`'[presta] received \${event.data}\`)
          if (event.data === 'refresh') {
            global.location.reload();
          }
        });

        socket.addEventListener('close', function () {
          console.log('[presta] disconnected')
        });
      })(this);
    <\/script>
  `}function et(t,e){return t.replace(e,"").split(".").reverse().slice(1).reverse().join("-").split("/").filter(Boolean).join("-")}function tt(t){let e=Object.values(t);return(0,be.default)(e.map(r=>r.route)).reduce((r,o)=>{let i=e.find(n=>n.route===o);return i?b(y({},r),{[i.src]:i}):r},{})}function R(t){var e,s,r;if(t)return(e=E(d.default.resolve(t)))==null?void 0:e.default;try{return(s=E(d.default.resolve(v)))==null?void 0:s.default}catch(o){if(c.default.existsSync(v))throw o;try{return(r=E(d.default.resolve(I)))==null?void 0:r.default}catch(i){if(c.default.existsSync(I))throw i}}return{}}function w(t,e={}){var o,i,n;let r={cwd:t.cwd||process.cwd(),files:t.files||[],assets:t.assets||"public",plugins:t.plugins||[],port:t.port||4e3,serve:(o=t.serve)!=null?o:!0,debug:!!t.debug,__unsafe_bundle_everything:(i=t.__unsafe_bundle_everything)!=null?i:!1,rawCliArgs:e};return((n=e._)==null?void 0:n.length)&&(r.files=e._),e.assets&&(r.assets=e.assets),e.port&&(r.port=e.port),e.serve&&(r.serve=e.serve==="true"),e.debug&&(r.debug=e.debug===!0),r.files&&(r.files=[].concat(r.files).map(a=>d.default.resolve(r.cwd,a))),r.assets&&(r.assets=d.default.resolve(r.cwd,r.assets)),r}function rt(t,e="html"){return d.default.extname(t)?t:e==="html"?`${t}/index.html`:`${t}.${e}`}function st(t){let e=((t==null?void 0:t.headers)||{})["content-type"];return M.default.extension(e)||"html"}function it(t,e){let s=Object.entries(e.functions).map(([r,{route:o}])=>({matcher:(0,ce.default)(o),file:r})).filter(({matcher:r})=>r.pattern.test(t.split("?")[0])).map(({file:r})=>r)[0];return{filepath:s,exports:s?E(s):void 0}}var C=class{constructor(e){this.cwd=process.cwd();this.mode=h.Dev;this.debug=!1;this.manifest={statics:{},functions:{}};this.files=[];this.events={internal:(0,A.smitter)(),external:(0,A.smitter)()};this.liveReloadScript="";this.cwd=e.cwd||process.cwd(),(0,me.config)({path:d.default.join(this.cwd,".env")}),(0,fe.addAliases)({"@":this.cwd}),this.config=w(e),this.debug=!!this.config.debug,this.logger={debug:(s,r)=>this._log("debug",s,r),info:(s,r)=>this._log("info",s,r),warn:(s,r)=>this._log("warn",s,r),error:(s,r)=>this._log("error",s,r)},this.logger.debug(`initialized with config ${JSON.stringify(e,null,"  ")}`)}async build(){if(this.mode=h.Build,this._init(),!this.files.length){this.logger.warn("no files were found, nothing to build");return}let e=x(),s=require(d.default.join(this.cwd,"package.json"));await c.default.remove(this.staticOutputDir),await c.default.remove(this.functionsOutputDir),c.default.existsSync(this.config.assets)&&await c.default.copy(this.config.assets,this.staticOutputDir),await this.buildFiles(this.files),await(0,ye.build)({entryPoints:Object.values(this.manifest.functions).map(({dest:r})=>r),outdir:this.functionsOutputDir,platform:"node",target:["node12"],minify:!0,allowOverwrite:!0,external:this.config.__unsafe_bundle_everything?[]:Object.keys(s.dependencies||{}),bundle:!0,define:{"process.env.PRESTA_SERVERLESS_RUNTIME":"true"}}),this.logger.info("presta build complete",{duration:e()}),this.events.external.emit("buildComplete")}async dev(){this.mode=h.Dev,this._init(),this.config.serve&&(await this._getPort(),this.liveReloadScript=this.config.serve?Ye({port:this.port}):"");let e=!1,s=await this._initDev(),r=async()=>{if(!e){e=!0;try{await s.cleanup(),this.debug||console.clear(),this.logger.info("\u267A restarting"),this.config=w(R(this.config.rawCliArgs.config),this.config.rawCliArgs),this._init(),s=await this._initDev(),this.events.internal.emit("devServerRestarted")}catch(i){this.logger.error(i)}e=!1}},o=T.default.watch([this.config.rawCliArgs.config&&d.default.resolve(this.config.rawCliArgs.config),v,I].filter(Boolean),{ignoreInitial:!0}).on("all",r);return this.events.internal.on("requestRestartDevServer",r),{async cleanup(){await s.cleanup(),await o.close()}}}serve(){this.mode=h.Serve,this._init(),this._serve()}restartDevServer(){if(this.mode!==h.Dev)throw new Error(`Requested a dev server restart in ${this.mode} mode`);this.events.internal.emit("requestRestartDevServer")}async buildFile(e){try{let{route:s,getStaticPaths:r,handler:o}=require(e);if(r){let i=await r(),n=[],a=this.manifest.statics[e]||[];if(!i.length){for(let p of a)await c.default.remove(p);this.manifest.statics[e]=[],this.logger.debug(`no built files detected, removing all previous artifacts for ${e}`);return}for(let p of i){let m=x(),u=P({path:p,pathParameters:s?j(p,s):{}}),f=$(await o(u,{})),S=((f==null?void 0:f.headers)||{})["content-type"],we=M.default.extension(S)||"html",Se=rt(p,we),Ee=f.body,Q=d.default.join(this.staticOutputDir,Se);c.default.outputFileSync(Q,Ee,"utf-8"),n.push(Q),this.logger.info(`\u25CF ${p}`,{duration:m()})}for(let p of a)n.includes(p)||(await c.default.remove(p),this.logger.debug(`detected removed file, cleaning up ${e}`));this.manifest.statics[e]=n}if(s){let i=x(),n=et(e,this.cwd),a="";this.mode===h.Build&&(a=d.default.join(this.functionsOutputDir,this.mode===h.Build?n+"-"+G(c.default.readFileSync(e,"utf8"))+".js":n+".js"),c.default.outputFileSync(a,`import { wrapHandler } from 'presta/runtime/wrapHandler';
import * as file from '${e}';
const mod = Object.assign({ config: {} }, file)
export const route = mod.route
export const config = mod.config
export const handler = wrapHandler(mod)`)),this.manifest.functions=tt(b(y({},this.manifest.functions),{[e]:{route:s,src:e,dest:a}})),this.logger.info(`\u03BB ${s}`,{duration:i()})}this._commitManifestToFile()}catch(s){this.logger.error(s)}}async buildFiles(e){await Promise.all(e.map(s=>this.buildFile(s)))}_init(){var e;((e=this.plugins)==null?void 0:e.length)&&this.plugins.forEach(s=>{s.cleanup&&(this._log("debug",`cleaning up ${s.name} plugin`),s.cleanup())}),this.prestaOutputDir=d.default.join(this.cwd,Ze),this.staticOutputDir=d.default.join(this.cwd,Ke),this.functionsOutputDir=d.default.join(this.cwd,Xe),this.manifestFilepath=d.default.join(this.prestaOutputDir,"manifest.json"),this.files=[].concat(this.config.files).map(s=>(0,ge.default)(s)).flat().map(s=>d.default.resolve(this.cwd,s)),this.plugins=this.config.plugins.map(s=>{let r=s({mode:this.mode,cwd:this.cwd,events:{on:this.events.external.on},logger:this.logger,getManifest:()=>this.manifest,getOutputDir:()=>this.prestaOutputDir,getStaticOutputDir:()=>this.staticOutputDir,getFunctionsOutputDir:()=>this.functionsOutputDir,restartDevServer:this.restartDevServer.bind(this)});return this.logger.debug(`${r.name} initialized`),r}),this.logger.debug(`presta start
${JSON.stringify(this,null,"  ")}`)}async _serve(){this.mode===h.Serve&&await this._getPort(),this.logger.info(`\u26A1\uFE0Ehttp://localhost:${this.port}`);let e=le.default.createServer((n,a)=>this._httpServerHandler(n,a)).listen(this.port),s=new ue.WebSocketServer({server:e}),r=[];e.on("connection",n=>{r.push(n),n.on("close",()=>r.splice(r.indexOf(n),1))});let o=()=>{this.logger.debug("refreshing browser"),s.clients.forEach(n=>n.send("refresh"))},i=[this.events.internal.on("devServerRestarted",()=>o()),this.events.internal.on("devFileAdded",()=>o()),this.events.internal.on("devFileRemoved",()=>o()),this.events.internal.on("devFileChanged",()=>o())];return{cleanup(){return new Promise(n=>{i.map(a=>a()),e.close(()=>n(1)),r.forEach(a=>a.destroy())})}}}_log(e,s,{duration:r}={}){if(!this.debug&&e==="debug")return;let i=B.default[{debug:"magenta",info:"reset",warn:"yellow",error:"red"}[e]];console[e]([B.default.gray(this.mode),i(String(s)),r&&`${B.default.gray(r)}`].filter(Boolean).join(" ")),e==="error"&&s instanceof Error&&console.error(s)}async _initDev(){let e=(0,he.create)({alias:{"@":this.cwd}}),s=T.default.watch(this.cwd,{ignoreInitial:!0,ignored:[this.staticOutputDir,this.functionsOutputDir,this.config.assets]}),r,o;return this.config.serve&&(r=await this._serve(),o=T.default.watch(this.config.assets,{ignoreInitial:!0}).on("all",(i,n)=>{this.logger.debug(`static asset ${n} changed`),this.events.internal.emit("devFileChanged")})),e.onChange(async i=>{this.logger.debug(`file ${i[0]} changed`),await this.buildFiles(i),this.events.internal.emit("devFileChanged")}),e.onRemove(async([i])=>{this.logger.debug(`file ${i} was removed`),this.files.splice(this.files.indexOf(i),1);let n=this.manifest.statics[i]||[],a=this.manifest.functions[i],p=n.map(m=>c.default.remove(m));a&&p.push(c.default.remove(a.dest)),await Promise.all(p),delete this.manifest.statics[i],delete this.manifest.functions[i],this.events.internal.emit("devFileRemoved")}),e.onError(i=>{this.logger.error(typeof i=="string"?new Error(i):i)}),await e.add(this.files),s.on("add",async i=>{!c.default.existsSync(i)||c.default.lstatSync(i).isDirectory()||!(0,ve.default)(this.config.files)(i)||this.files.includes(i)||(this.logger.debug(`${i} added`),this.files.push(i),await e.add(i),await this.buildFile(i),this.events.internal.emit("devFileAdded"))}),await c.default.remove(this.staticOutputDir),await c.default.remove(this.functionsOutputDir),await this.buildFiles(this.files),{async cleanup(){await Promise.all([e.close(),s.close(),o&&o.close(),r&&r.cleanup()].filter(Boolean))}}}async _getPort(){let e=this.config.port||4e3;this.port=await(0,de.default)({port:e}),this.port!==e&&this.logger.debug(`desired port ${e} not available, assigning ${this.port}`)}async _commitManifestToFile(){return c.default.outputFileSync(this.manifestFilepath,JSON.stringify(this.manifest,null,"  "))}async _httpServerHandler(e,s){let r=x();this.logger.debug(`handling ${e.url}`),this._httpTryServeFile(e,s,async o=>{o?this.logger.info(`\u26A1\uFE0E${e.url} ${s.statusCode}`,{duration:r()}):await this._httpTryServeLambda(e,s)})}async _httpTryServeFile(e,s,r){let{pathname:o}=new URL(e.url,"https://presta.dev"),i=M.default.lookup(o)||"text/html",n=i==="text/html",a=d.default.join(this.config.assets,o),p=d.default.join(this.staticOutputDir,o),m=!1,u=[a,p,d.default.join(a,"index.html"),d.default.join(p,"index.html")];for(let f of u)if(this.logger.debug(`attempting to serve ${f} as ${i}`),c.default.existsSync(f)){if(c.default.statSync(f).isDirectory())continue;if(s.writeHead(200,{"content-type":i}),n){let S=c.default.readFileSync(f,"utf8");S+=this.liveReloadScript,s.end(S)}else c.default.createReadStream(f).pipe(s);m=!0;break}r(m)}async _httpTryServeLambda(e,s){var a;let r=x(),o=await te(e),i=o.headers.Accept||o.headers.accept,n=i&&i.includes("json");this.logger.debug(`handling function request ${o.path}`);try{let{filepath:p,exports:m}=it(o.path,this.manifest);if(!m){this.logger.error(`\u26A1\uFE0E${o.path} ${404}`,{duration:r()}),k(s,{statusCode:404});return}if(!m.handler)throw new q(`file ${p} does not export a \`handler\``,404);let u=await ae(m)(o,{}),f=u.statusCode>299&&u.statusCode<399;(f?void 0:st(u))==="html"&&(u.body=(u.body||"").split("</body>")[0]+this.liveReloadScript),k(s,u),this.logger.info(`\u26A1\uFE0E${f&&((a=u==null?void 0:u.headers)==null?void 0:a.Location)||o.path} ${u.statusCode}`,{duration:r()})}catch(p){let m=p,{statusCode:u=500}=m;u>499&&this.logger.error(m);let f=n?ne({statusCode:u,body:{detail:pe.default.message[u]}}):H({statusCode:u,body:re({statusCode:u})});this.logger.error(m),this.logger.error(`\u26A1\uFE0E${o.path} ${f.statusCode}`,{duration:r()}),k(s,f)}}};(0,Pe.register)();var D=(0,xe.default)("presta");D.version(W.version).option("--config, -c",`Path to a config file.  (default ${v})`).option("--staticOutputDir","Specify output directory for built static files.  (default ./.presta/static/)").option("--functionsOutputDir","Specify output directory for built serverless functions.  (default ./.presta/functions/)").option("--assets, -a","Specify static asset directory.  (default ./public)").option("--debug, -d","Enable debug mode (prints more logs)").example("dev index.jsx -o dist").example("dev 'pages/*.tsx' -o static").example("'pages/*.tsx'").example("-c site.json").example("serve -p 8080");D.command("build","Build project to output directory.",{default:!0}).example("").example("files/**/*.js").example(`-c ${v}`).action(async t=>{process.env.PRESTA_ENV="Production",process.env.PRESTA_DEBUG=t.debug?"debug":"",console.clear();let e=w(R(t.config),t);await new C(e).build()});D.command("dev","Start Presta dev server and watch files",{alias:"watch"}).option("--port, -p","Port to run the local server.  (default 4000)").option("--serve, -s","Run local dev server.  (default true)").describe("Watch project and build to output directory.").example("dev").example("dev ./files/**/*.js").example("dev ./files/**/*.js -o ./out").example(`dev -c ${v}`).action(async t=>{process.env.PRESTA_ENV="Development",process.env.PRESTA_DEBUG=t.debug?"debug":"",console.clear();let e=w(R(t.config),t);new C(e).dev()});D.command("serve").option("--port, -p","Port to run the local server.  (default 4000)").describe("Serve built files, lambdas, and static assets.").example("serve").example("serve -o ./out -p 8080").example(`serve -c ${v}`).action(async t=>{process.env.PRESTA_ENV="Development",process.env.PRESTA_DEBUG=t.debug?"debug":"",console.clear();let e=w(R(t.config),t);new C(e).serve()});D.parse(process.argv);
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibGliL2Jpbi50cyIsICJsaWIvY29yZS50cyIsICJsaWIvdXRpbHMvcmVxdWlyZUZyZXNoLnRzIiwgImxpYi91dGlscy90aW1lci50cyIsICJsaWIvdXRpbHMvaGFzaENvbnRlbnQudHMiLCAibGliL3V0aWxzL3JlcXVlc3RUb0V2ZW50LnRzIiwgImxpYi9ydW50aW1lL3BhcnNlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzLnRzIiwgImxpYi9ydW50aW1lL2lzQmFzZTY0RW5jb2RlZENvbnRlbnRUeXBlLnRzIiwgImxpYi9ydW50aW1lL25vcm1hbGl6ZUV2ZW50LnRzIiwgImxpYi9ydW50aW1lL25vcm1hbGl6ZVJlcXVlc3RIZWFkZXJzLnRzIiwgImxpYi91dGlscy9jcmVhdGVEZWZhdWx0SHRtbFJlc3BvbnNlLnRzIiwgImxpYi9ydW50aW1lL3BhcnNlUGF0aFBhcmFtZXRlcnMudHMiLCAibGliL3J1bnRpbWUvc2VuZFNlcnZlcmxlc3NSZXNwb25zZS50cyIsICJsaWIvcnVudGltZS9ub3JtYWxpemVSZXNwb25zZUhlYWRlcnMudHMiLCAibGliL3NlcmlhbGl6ZS50cyIsICJsaWIvcnVudGltZS9ub3JtYWxpemVSZXNwb25zZS50cyIsICJsaWIvcnVudGltZS93cmFwSGFuZGxlci50cyIsICJsaWIvaW5kZXgudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIiMhL3Vzci9iaW4vZW52IG5vZGVcblxuaW1wb3J0IHNhZGUgZnJvbSAnc2FkZSdcbmltcG9ydCB7IHJlZ2lzdGVyIGFzIGVzYnVpbGQgfSBmcm9tICdlc2J1aWxkLXJlZ2lzdGVyL2Rpc3Qvbm9kZSdcblxuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IHBrZyBmcm9tICcuLi9wYWNrYWdlLmpzb24nXG5pbXBvcnQgeyBkZWZhdWx0SlNDb25maWdGaWxlcGF0aCwgZmluZEFuZFBhcnNlQ29uZmlnRmlsZSwgbWVyZ2VDb25maWcsIFByZXN0YUNsaUFyZ3MsIFByZXN0YSB9IGZyb20gJy4vY29yZSdcblxuZXNidWlsZCgpXG5cbmNvbnN0IHByb2dyYW0gPSBzYWRlKCdwcmVzdGEnKVxuXG5wcm9ncmFtXG4gIC52ZXJzaW9uKHBrZy52ZXJzaW9uKVxuICAvLyBkbyBub3QgcHJvdmlkZSBkZWZhdWx0IGNvbmZpZyBoZXJlXG4gIC5vcHRpb24oJy0tY29uZmlnLCAtYycsIGBQYXRoIHRvIGEgY29uZmlnIGZpbGUuICAoZGVmYXVsdCAke2RlZmF1bHRKU0NvbmZpZ0ZpbGVwYXRofSlgKVxuICAub3B0aW9uKCctLXN0YXRpY091dHB1dERpcicsIGBTcGVjaWZ5IG91dHB1dCBkaXJlY3RvcnkgZm9yIGJ1aWx0IHN0YXRpYyBmaWxlcy4gIChkZWZhdWx0IC4vLnByZXN0YS9zdGF0aWMvKWApXG4gIC5vcHRpb24oXG4gICAgJy0tZnVuY3Rpb25zT3V0cHV0RGlyJyxcbiAgICBgU3BlY2lmeSBvdXRwdXQgZGlyZWN0b3J5IGZvciBidWlsdCBzZXJ2ZXJsZXNzIGZ1bmN0aW9ucy4gIChkZWZhdWx0IC4vLnByZXN0YS9mdW5jdGlvbnMvKWBcbiAgKVxuICAub3B0aW9uKCctLWFzc2V0cywgLWEnLCBgU3BlY2lmeSBzdGF0aWMgYXNzZXQgZGlyZWN0b3J5LiAgKGRlZmF1bHQgLi9wdWJsaWMpYClcbiAgLm9wdGlvbignLS1kZWJ1ZywgLWQnLCBgRW5hYmxlIGRlYnVnIG1vZGUgKHByaW50cyBtb3JlIGxvZ3MpYClcbiAgLmV4YW1wbGUoYGRldiBpbmRleC5qc3ggLW8gZGlzdGApXG4gIC5leGFtcGxlKGBkZXYgJ3BhZ2VzLyoudHN4JyAtbyBzdGF0aWNgKVxuICAuZXhhbXBsZShgJ3BhZ2VzLyoudHN4J2ApXG4gIC5leGFtcGxlKGAtYyBzaXRlLmpzb25gKVxuICAuZXhhbXBsZShgc2VydmUgLXAgODA4MGApXG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoJ2J1aWxkJywgJ0J1aWxkIHByb2plY3QgdG8gb3V0cHV0IGRpcmVjdG9yeS4nLCB7IGRlZmF1bHQ6IHRydWUgfSlcbiAgLmV4YW1wbGUoYGApXG4gIC5leGFtcGxlKGBmaWxlcy8qKi8qLmpzYClcbiAgLmV4YW1wbGUoYC1jICR7ZGVmYXVsdEpTQ29uZmlnRmlsZXBhdGh9YClcbiAgLmFjdGlvbihhc3luYyAoY2xpQXJnczogUHJlc3RhQ2xpQXJncykgPT4ge1xuICAgIHByb2Nlc3MuZW52LlBSRVNUQV9FTlYgPSAnUHJvZHVjdGlvbicgLy8gVE9ET1xuICAgIHByb2Nlc3MuZW52LlBSRVNUQV9ERUJVRyA9IGNsaUFyZ3MuZGVidWcgPyAnZGVidWcnIDogJydcbiAgICBjb25zb2xlLmNsZWFyKClcbiAgICBjb25zdCBjb25maWcgPSBtZXJnZUNvbmZpZyhmaW5kQW5kUGFyc2VDb25maWdGaWxlKGNsaUFyZ3MuY29uZmlnKSwgY2xpQXJncylcbiAgICBhd2FpdCBuZXcgUHJlc3RhKGNvbmZpZykuYnVpbGQoKVxuICB9KVxuXG5wcm9ncmFtXG4gIC5jb21tYW5kKCdkZXYnLCAnU3RhcnQgUHJlc3RhIGRldiBzZXJ2ZXIgYW5kIHdhdGNoIGZpbGVzJywgeyBhbGlhczogJ3dhdGNoJyB9KVxuICAub3B0aW9uKCctLXBvcnQsIC1wJywgYFBvcnQgdG8gcnVuIHRoZSBsb2NhbCBzZXJ2ZXIuICAoZGVmYXVsdCA0MDAwKWApXG4gIC5vcHRpb24oJy0tc2VydmUsIC1zJywgYFJ1biBsb2NhbCBkZXYgc2VydmVyLiAgKGRlZmF1bHQgdHJ1ZSlgKVxuICAuZGVzY3JpYmUoJ1dhdGNoIHByb2plY3QgYW5kIGJ1aWxkIHRvIG91dHB1dCBkaXJlY3RvcnkuJylcbiAgLmV4YW1wbGUoYGRldmApXG4gIC5leGFtcGxlKGBkZXYgLi9maWxlcy8qKi8qLmpzYClcbiAgLmV4YW1wbGUoYGRldiAuL2ZpbGVzLyoqLyouanMgLW8gLi9vdXRgKVxuICAuZXhhbXBsZShgZGV2IC1jICR7ZGVmYXVsdEpTQ29uZmlnRmlsZXBhdGh9YClcbiAgLmFjdGlvbihhc3luYyAoY2xpQXJnczogUHJlc3RhQ2xpQXJncykgPT4ge1xuICAgIHByb2Nlc3MuZW52LlBSRVNUQV9FTlYgPSAnRGV2ZWxvcG1lbnQnIC8vIFRPRE9cbiAgICBwcm9jZXNzLmVudi5QUkVTVEFfREVCVUcgPSBjbGlBcmdzLmRlYnVnID8gJ2RlYnVnJyA6ICcnXG4gICAgY29uc29sZS5jbGVhcigpXG4gICAgY29uc3QgY29uZmlnID0gbWVyZ2VDb25maWcoZmluZEFuZFBhcnNlQ29uZmlnRmlsZShjbGlBcmdzLmNvbmZpZyksIGNsaUFyZ3MpXG4gICAgbmV3IFByZXN0YShjb25maWcpLmRldigpXG4gIH0pXG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoJ3NlcnZlJylcbiAgLm9wdGlvbignLS1wb3J0LCAtcCcsIGBQb3J0IHRvIHJ1biB0aGUgbG9jYWwgc2VydmVyLiAgKGRlZmF1bHQgNDAwMClgKVxuICAuZGVzY3JpYmUoJ1NlcnZlIGJ1aWx0IGZpbGVzLCBsYW1iZGFzLCBhbmQgc3RhdGljIGFzc2V0cy4nKVxuICAuZXhhbXBsZShgc2VydmVgKVxuICAuZXhhbXBsZShgc2VydmUgLW8gLi9vdXQgLXAgODA4MGApXG4gIC5leGFtcGxlKGBzZXJ2ZSAtYyAke2RlZmF1bHRKU0NvbmZpZ0ZpbGVwYXRofWApXG4gIC5hY3Rpb24oYXN5bmMgKGNsaUFyZ3M6IFByZXN0YUNsaUFyZ3MpID0+IHtcbiAgICBwcm9jZXNzLmVudi5QUkVTVEFfRU5WID0gJ0RldmVsb3BtZW50JyAvLyBUT0RPXG4gICAgcHJvY2Vzcy5lbnYuUFJFU1RBX0RFQlVHID0gY2xpQXJncy5kZWJ1ZyA/ICdkZWJ1ZycgOiAnJ1xuICAgIGNvbnNvbGUuY2xlYXIoKVxuICAgIGNvbnN0IGNvbmZpZyA9IG1lcmdlQ29uZmlnKGZpbmRBbmRQYXJzZUNvbmZpZ0ZpbGUoY2xpQXJncy5jb25maWcpLCBjbGlBcmdzKVxuICAgIG5ldyBQcmVzdGEoY29uZmlnKS5zZXJ2ZSgpXG4gIH0pXG5cbnByb2dyYW0ucGFyc2UocHJvY2Vzcy5hcmd2KVxuIiwgImltcG9ydCB7IFNvY2tldCB9IGZyb20gJ25ldCdcbmltcG9ydCBodHRwIGZyb20gJ2h0dHAnXG5pbXBvcnQgdG9SZWdFeHAgZnJvbSAncmVnZXhwYXJhbSdcbmltcG9ydCBzdGF0dXMgZnJvbSAnc3RhdHVzZXMnXG5pbXBvcnQgeyBXZWJTb2NrZXRTZXJ2ZXIgfSBmcm9tICd3cydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZ2V0UG9ydCBmcm9tICdnZXQtcG9ydCdcbmltcG9ydCB7IGNvbmZpZyBhcyBkb3RlbnYgfSBmcm9tICdkb3RlbnYnXG5pbXBvcnQgeyBhZGRBbGlhc2VzIH0gZnJvbSAnbW9kdWxlLWFsaWFzJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJ1xuaW1wb3J0IGdsb2JTeW5jIGZyb20gJ3RpbnktZ2xvYi9zeW5jJ1xuaW1wb3J0IG1pbWUgZnJvbSAnbWltZS10eXBlcydcbmltcG9ydCB7IGNyZWF0ZSB9IGZyb20gJ3dhdGNoLWRlcGVuZGVuY3ktZ3JhcGgnXG5pbXBvcnQgY2hva2lkYXIgZnJvbSAnY2hva2lkYXInXG5pbXBvcnQgbWF0Y2ggZnJvbSAncGljb21hdGNoJ1xuaW1wb3J0IHsgYnVpbGQgYXMgZXNidWlsZCB9IGZyb20gJ2VzYnVpbGQnXG5pbXBvcnQgeyBzbWl0dGVyLCBTbWl0dGVyIH0gZnJvbSAnc21pdHRlcidcbmltcG9ydCBrbGV1ciwgeyBLbGV1ciB9IGZyb20gJ2tsZXVyJ1xuaW1wb3J0IHJzb3J0IGZyb20gJ3JvdXRlLXNvcnQnXG5pbXBvcnQge1xuICBQYXJhbXMsXG4gIE11bHRpVmFsdWVQYXJhbXMsXG4gIEV2ZW50IGFzIExhbWJkYUV2ZW50LFxuICBDb250ZXh0IGFzIExhbWJkYUNvbnRleHQsXG4gIFJlc3BvbnNlIGFzIExhbWJkYVJlc3BvbnNlLFxufSBmcm9tICdsYW1iZGEtdHlwZXMnXG5cbmltcG9ydCB7IHJlcXVpcmVGcmVzaCB9IGZyb20gJy4vdXRpbHMvcmVxdWlyZUZyZXNoJ1xuaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL3V0aWxzL3RpbWVyJ1xuaW1wb3J0IHsgaGFzaENvbnRlbnQgfSBmcm9tICcuL3V0aWxzL2hhc2hDb250ZW50J1xuaW1wb3J0IHsgcmVxdWVzdFRvRXZlbnQgfSBmcm9tICcuL3V0aWxzL3JlcXVlc3RUb0V2ZW50J1xuaW1wb3J0IHsgY3JlYXRlRGVmYXVsdEh0bWxSZXNwb25zZSB9IGZyb20gJy4vdXRpbHMvY3JlYXRlRGVmYXVsdEh0bWxSZXNwb25zZSdcblxuaW1wb3J0IHsgcGFyc2VQYXRoUGFyYW1ldGVycyB9IGZyb20gJy4vcnVudGltZS9wYXJzZVBhdGhQYXJhbWV0ZXJzJ1xuaW1wb3J0IHsgc2VuZFNlcnZlcmxlc3NSZXNwb25zZSB9IGZyb20gJy4vcnVudGltZS9zZW5kU2VydmVybGVzc1Jlc3BvbnNlJ1xuaW1wb3J0IHsgbm9ybWFsaXplRXZlbnQgfSBmcm9tICcuL3J1bnRpbWUvbm9ybWFsaXplRXZlbnQnXG5pbXBvcnQgeyBub3JtYWxpemVSZXNwb25zZSB9IGZyb20gJy4vcnVudGltZS9ub3JtYWxpemVSZXNwb25zZSdcbmltcG9ydCB7IHdyYXBIYW5kbGVyIH0gZnJvbSAnLi9ydW50aW1lL3dyYXBIYW5kbGVyJ1xuXG5pbXBvcnQgeyBIdHRwRXJyb3IsIE1vZGUgfSBmcm9tICcuLydcbmltcG9ydCAqIGFzIHNlcmlhbGl6ZSBmcm9tICcuL3NlcmlhbGl6ZSdcblxuLy8gVE9ETyBhZGQgb3B0aW9uIG5vdCB0byBidWlsZCBldmVyeXRoaW5nIG9uIHN0YXJ0dXBcbi8vIFRPRE8gb3V0cHV0dGluZyBkaXJlY3RseSB0byBwbGF0Zm9ybSBkaXJzIG1lYW5zIG5vIHJlYWRpbmcgb2YgZXhwb3J0ZWQgeyBjb25maWcgfSBieSBwbHVnaW5zLCBtYXliZSBJIG5lZWQgYSBsaWZlY3ljbGUgaG9vayB0byBwcm9jZXNzIGluIHNpdHVcblxuZXhwb3J0IHR5cGUgUHJlc3RhQ29uZmlnID0ge1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIHRoZSBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IChkZWZhdWx0IGBwcm9jZXNzLmN3ZCgpYClcbiAgICovXG4gIGN3ZDogc3RyaW5nXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gZmlsZSBnbG9icyB0byBpbmNsdWRlIGluIGJ1aWxkIHByb2Nlc3NcbiAgICovXG4gIGZpbGVzOiBzdHJpbmdbXVxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIHBhdGggdG8gc3RhdGljIGFzc2V0IGRpcmVjdG9yeSAoZGVmYXVsdCBgLi9wdWJsaWNgKVxuICAgKi9cbiAgYXNzZXRzOiBzdHJpbmdcbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiBhcnJheSBvZiBQcmVzdGEgcGx1Z2luc1xuICAgKi9cbiAgcGx1Z2luczogUGx1Z2luW11cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiB1c2VyIHJlcXVlc3RlZCBwb3J0IChkZWZhdWx0IGA0MDAwYClcbiAgICovXG4gIHBvcnQ6IG51bWJlclxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIHdoZXRoZXIgb3Igbm90IHRvIHJ1biB0aGUgbG9jYWwgZGV2IEhUVFAgc2VydmVyIChkZWZhdWx0IGBmYWxzZWApXG4gICAqL1xuICBzZXJ2ZTogYm9vbGVhblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIG9wdGlvbiB0byBvdXRwdXQgZGVidWcgbG9ncyBkdXJpbmcgZGV2IChkZWZhdWx0IGBmYWxzZWApXG4gICAqL1xuICBkZWJ1Zz86IGJvb2xlYW5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiB0aGUgcmF3IGFyZ3MgcGFzc2VkIGluIHZpYSB0aGUgUHJlc3RhIENMSVxuICAgKi9cbiAgcmF3Q2xpQXJnczogUHJlc3RhQ2xpQXJnc1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIGluY2x1ZXMgYWxsIGRlcGVuZGVuY2llcyBpbiB0aGUgZmluYWwgYnVuZGxlIGluc3RlYWQgb2ZcbiAgICogZXh0ZXJuYWxpemluZyB0aGVtXG4gICAqL1xuICBfX3Vuc2FmZV9idW5kbGVfZXZlcnl0aGluZzogYm9vbGVhblxufVxuXG5leHBvcnQgdHlwZSBQcmVzdGFDbGlBcmdzID0ge1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIHZhcmlhZGljIENMSSBhcmdzIChQcmVzdGEgZmlsZXMpXG4gICAqL1xuICBfPzogc3RyaW5nW10gLy8gZmlsZXNcbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiB1c2VyIHByb3ZpZGVkIGNvbmZpZyBmaWxlcGF0aFxuICAgKi9cbiAgY29uZmlnPzogc3RyaW5nXG4gIC8qKlxuICAgKiBSZS1kZWNsYXJlZCBiZWNhdXNlIENMSSBhcmcgY29tZXMgaW4gYXMgYSBzdHJpbmdcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uIHdoZXRoZXIgb3Igbm90IHRvIHJ1biB0aGUgbG9jYWwgZGV2IEhUVFAgc2VydmVyIChkZWZhdWx0IGBmYWxzZWApXG4gICAqL1xuICBzZXJ2ZT86IHN0cmluZ1xuICAvKipcbiAgICogUmUtZGVjbGFyZWQgYmVjYXVzZSBDTEkgYXJnIGNvbWVzIGluIGFzIGEgc3RyaW5nXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvbiBvcHRpb24gdG8gb3V0cHV0IGRlYnVnIGxvZ3MgZHVyaW5nIGRldiAoZGVmYXVsdCBgZmFsc2VgKVxuICAgKi9cbiAgZGVidWc/OiBzdHJpbmdcbn0gJiBQYXJ0aWFsPE9taXQ8UHJlc3RhQ29uZmlnLCAnZmlsZXMnIHwgJ3BsdWdpbnMnIHwgJ3Jhd0NsaUFyZ3MnIHwgJ3NlcnZlJz4+XG5cbmV4cG9ydCB0eXBlIEhlYWRlcnMgPSBQYXJhbXNcbmV4cG9ydCB0eXBlIE11bHRpVmFsdWVIZWFkZXJzID0gTXVsdGlWYWx1ZVBhcmFtc1xuZXhwb3J0IHR5cGUgUXVlcnlTdHJpbmdQYXJhbWV0ZXJzID0gUGFyYW1zXG5leHBvcnQgdHlwZSBNdWx0aVZhbHVlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzID0gTXVsdGlWYWx1ZVBhcmFtc1xuZXhwb3J0IHR5cGUgUGF0aFBhcmFtZXRlcnMgPSBQYXJhbXNcblxuZXhwb3J0IHR5cGUgRXZlbnQgPSBPbWl0PFxuICBMYW1iZGFFdmVudCxcbiAgJ3F1ZXJ5U3RyaW5nUGFyYW1ldGVycycgfCAnbXVsdGlWYWx1ZVF1ZXJ5U3RyaW5nUGFyYW1ldGVycycgfCAncGF0aFBhcmFtZXRlcnMnXG4+ICYge1xuICBxdWVyeVN0cmluZ1BhcmFtZXRlcnM6IFBhcmFtc1xuICBtdWx0aVZhbHVlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiBNdWx0aVZhbHVlUGFyYW1zXG4gIHBhdGhQYXJhbWV0ZXJzOiBQYXJhbXNcbn1cbmV4cG9ydCB0eXBlIENvbnRleHQgPSBMYW1iZGFDb250ZXh0ICYge1xuICBba2V5OiBzdHJpbmddOiB1bmtub3duXG59XG5leHBvcnQgdHlwZSBSZXNwb25zZSA9IE9taXQ8TGFtYmRhUmVzcG9uc2UsICdzdGF0dXNDb2RlJz4gJiB7XG4gIHN0YXR1c0NvZGU/OiBudW1iZXJcbn1cblxuZXhwb3J0IHR5cGUgSGFuZGxlciA9IChldmVudDogRXZlbnQsIGNvbnRleHQ6IENvbnRleHQpID0+IFByb21pc2U8UmVzcG9uc2UgfCBzdHJpbmc+IHwgUmVzcG9uc2UgfCBzdHJpbmdcbmV4cG9ydCB0eXBlIEFXU0xhbWJkYSA9IChldmVudDogRXZlbnQsIGNvbnRleHQ6IENvbnRleHQpID0+IFByb21pc2U8TGFtYmRhUmVzcG9uc2U+XG5cbmV4cG9ydCB0eXBlIFByZXN0YUZpbGUgPSB7XG4gIHJvdXRlPzogc3RyaW5nXG4gIGdldFN0YXRpY1BhdGhzPzogKCkgPT4gUHJvbWlzZTxzdHJpbmdbXT5cbiAgaGFuZGxlcjogSGFuZGxlclxufVxuXG5leHBvcnQgdHlwZSBQcmVzdGFGdW5jdGlvbkZpbGUgPSBQcmVzdGFGaWxlICYge1xuICByb3V0ZTogc3RyaW5nXG59XG5cbmV4cG9ydCB0eXBlIFByZXN0YVN0YXRpY0ZpbGUgPSBQcmVzdGFGaWxlICYge1xuICBnZXRTdGF0aWNQYXRoczogKCkgPT4gUHJvbWlzZTxzdHJpbmdbXT5cbn1cblxuZXhwb3J0IHR5cGUgTWFuaWZlc3QgPSB7XG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gVGhlIGJ1aWx0IHBhZ2VzIGFuZCBmaWxlcyBmcm9tIHRoZSBQcmVzdGEgcHJvY2Vzcy4gVGhlc2UgYXJlXG4gICAqIG91dHB1dCB0byB0aGUgc2FtZSBkaXJlY3RvcnkgYXMgdGhlIGBjb25maWcuYXNzZXRzYCBzdGF0aWMgYXNzZXRzLlxuICAgKi9cbiAgc3RhdGljczogeyBbZmlsZXBhdGg6IHN0cmluZ106IHN0cmluZ1tdIH1cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiBUaGUgYnVpbHQgQVdTIExhbWJkYS1mbGF2b3JlZCBzZXJ2ZXJsZXNzIGZ1bmN0aW9uc1xuICAgKi9cbiAgZnVuY3Rpb25zOiB7IFtmaWxlcGF0aDogc3RyaW5nXTogeyByb3V0ZTogc3RyaW5nOyBzcmM6IHN0cmluZzsgZGVzdDogc3RyaW5nIH0gfVxufVxuXG5leHBvcnQgdHlwZSBJbnRlcm5hbEV2ZW50cyA9IHtcbiAgZGV2U2VydmVyUmVzdGFydGVkOiB1bmRlZmluZWRcbiAgcmVxdWVzdFJlc3RhcnREZXZTZXJ2ZXI6IHVuZGVmaW5lZFxuICBkZXZGaWxlQWRkZWQ6IHVuZGVmaW5lZFxuICBkZXZGaWxlUmVtb3ZlZDogdW5kZWZpbmVkXG4gIGRldkZpbGVDaGFuZ2VkOiB1bmRlZmluZWRcbn1cblxuZXhwb3J0IHR5cGUgRXh0ZXJuYWxFdmVudHMgPSB7XG4gIGJ1aWxkQ29tcGxldGU6IHVuZGVmaW5lZFxufVxuXG5leHBvcnQgdHlwZSBMb2dnZXJNZXRhZGF0YSA9IHtcbiAgZHVyYXRpb24/OiBzdHJpbmdcbn1cblxuZXhwb3J0IHR5cGUgTG9nZ2VyID0ge1xuICBkZWJ1ZyhtZXNzYWdlOiBzdHJpbmcsIG1ldGFkYXRhPzogTG9nZ2VyTWV0YWRhdGEpOiB2b2lkXG4gIGluZm8obWVzc2FnZTogc3RyaW5nLCBtZXRhZGF0YT86IExvZ2dlck1ldGFkYXRhKTogdm9pZFxuICB3YXJuKG1lc3NhZ2U6IHN0cmluZywgbWV0YWRhdGE/OiBMb2dnZXJNZXRhZGF0YSk6IHZvaWRcbiAgZXJyb3IoZXJyb3I6IEVycm9yIHwgc3RyaW5nLCBtZXRhZGF0YT86IExvZ2dlck1ldGFkYXRhKTogdm9pZFxufVxuXG5leHBvcnQgdHlwZSBQbHVnaW5JbnRlcmZhY2UgPSB7XG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gVGhlIHBhY2thZ2UgbmFtZSBvZiB0aGUgUHJlc3RhIHBsdWdpbiBlLmcuXG4gICAqIGBAcHJlc3RhL2FkYXB0ZXItbmV0bGlmeWBcbiAgICovXG4gIG5hbWU6IHN0cmluZ1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIENhbGxlZCB3aGVuIGRldiBzZXJ2ZXIgcmVzdGFydHMsIGxpa2UgYWZ0ZXIgYW4gZWRpdCBpcyBtYWRlXG4gICAqIHRvIHRoZSBjb25maWcgZmlsZS4gQ2xlYW4gdXAgYW55IGFuZCBhbGwgbGlzdGVuZXJzIGFuZCBzaWRlLWVmZmVjdHMgd2l0aGluXG4gICAqIHRoaXMgbWV0aG9kLlxuICAgKi9cbiAgY2xlYW51cD8oKTogdm9pZFxufVxuXG5leHBvcnQgdHlwZSBQbHVnaW5Db250ZXh0ID0ge1xuICBtb2RlOiBNb2RlXG4gIGN3ZDogc3RyaW5nXG4gIGV2ZW50czogeyBvbjogU21pdHRlcjxFeHRlcm5hbEV2ZW50cz5bJ29uJ10gfVxuICBsb2dnZXI6IExvZ2dlclxuICBnZXRNYW5pZmVzdCgpOiBNYW5pZmVzdFxuICBnZXRPdXRwdXREaXIoKTogc3RyaW5nXG4gIGdldFN0YXRpY091dHB1dERpcigpOiBzdHJpbmdcbiAgZ2V0RnVuY3Rpb25zT3V0cHV0RGlyKCk6IHN0cmluZ1xuICByZXN0YXJ0RGV2U2VydmVyKCk6IHZvaWRcbn1cblxuZXhwb3J0IHR5cGUgUGx1Z2luID0gKGNvbnRleHQ6IFBsdWdpbkNvbnRleHQpID0+IFBsdWdpbkludGVyZmFjZVxuXG5leHBvcnQgdHlwZSBMb2dMZXZlbCA9ICdkZWJ1ZycgfCAnaW5mbycgfCAnd2FybicgfCAnZXJyb3InXG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0SlNDb25maWdGaWxlcGF0aCA9ICdwcmVzdGEuY29uZmlnLmpzJ1xuZXhwb3J0IGNvbnN0IGRlZmF1bHRUU0NvbmZpZ0ZpbGVwYXRoID0gJ3ByZXN0YS5jb25maWcudHMnXG5leHBvcnQgY29uc3Qgcm9vdE91dHB1dERpciA9ICcuLy5wcmVzdGEnXG5leHBvcnQgY29uc3QgZnVuY3Rpb25zT3V0cHV0RGlyID0gJy4vLnByZXN0YS9mdW5jdGlvbnMnXG5leHBvcnQgY29uc3Qgc3RhdGljT3V0cHV0RGlyID0gJy4vLnByZXN0YS9zdGF0aWMnXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVMaXZlUmVsb2FkU2NyaXB0KHsgcG9ydCB9OiB7IHBvcnQ6IG51bWJlciB9KSB7XG4gIHJldHVybiBgXG4gICAgPHNjcmlwdD5cbiAgICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICAgIHZhciBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KCd3czovL2xvY2FsaG9zdDoke3BvcnR9Jyk7XG5cbiAgICAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnW3ByZXN0YV0gY29ubmVjdGVkIG9uIHBvcnQgJHtwb3J0fScpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXFxgJ1twcmVzdGFdIHJlY2VpdmVkIFxcJFxce2V2ZW50LmRhdGFcXH1cXGApXG4gICAgICAgICAgaWYgKGV2ZW50LmRhdGEgPT09ICdyZWZyZXNoJykge1xuICAgICAgICAgICAgZ2xvYmFsLmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdbcHJlc3RhXSBkaXNjb25uZWN0ZWQnKVxuICAgICAgICB9KTtcbiAgICAgIH0pKHRoaXMpO1xuICAgIDwvc2NyaXB0PlxuICBgXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzbHVnaWZ5KGZpbGVuYW1lOiBzdHJpbmcsIGN3ZDogc3RyaW5nKSB7XG4gIHJldHVybiBmaWxlbmFtZVxuICAgIC5yZXBsYWNlKGN3ZCwgJycpIC8vIC9wYWdlcy9GaWxlLnBhZ2UuanNcbiAgICAuc3BsaXQoJy4nKSAvLyBleHRlbnNpb24sIFsvcGFnZXMvRmlsZSwgcGFnZSwganNdXG4gICAgLnJldmVyc2UoKVxuICAgIC5zbGljZSgxKVxuICAgIC5yZXZlcnNlKClcbiAgICAuam9pbignLScpIC8vIC9wYWdlcy9GaWxlLnBhZ2VcbiAgICAuc3BsaXQoJy8nKVxuICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAuam9pbignLScpIC8vIHBhZ2VzLUZpbGUtcGFnZVxufVxuXG4vKipcbiAqIEFjY2VwdHMgdGhlIE1hbmlmZXN0J3MgZnVuY3Rpb25zIG9iamVjdCBhbmQgc29ydHMgaXQgYWNjb3JkaW5nIHRvIHJvdXRlXG4gKiBwcmlvcml0eSwgcmV0dXJuaW5nIHRoZSBmdWxsIG9iamVjdFxuICovXG5leHBvcnQgZnVuY3Rpb24gc29ydE1hbmlmZXN0RnVuY3Rpb25zKGZ1bmN0aW9uczogTWFuaWZlc3RbJ2Z1bmN0aW9ucyddKSB7XG4gIGNvbnN0IGZpbGVzID0gT2JqZWN0LnZhbHVlcyhmdW5jdGlvbnMpXG4gIGNvbnN0IHNvcnRlZFJvdXRlcyA9IHJzb3J0KGZpbGVzLm1hcCgoZikgPT4gZi5yb3V0ZSkpXG4gIHJldHVybiBzb3J0ZWRSb3V0ZXMucmVkdWNlKChmbnMsIHJvdXRlKSA9PiB7XG4gICAgY29uc3QgZmlsZSA9IGZpbGVzLmZpbmQoKGYpID0+IGYucm91dGUgPT09IHJvdXRlKVxuICAgIGlmICghZmlsZSkgcmV0dXJuIGZuc1xuICAgIHJldHVybiB7XG4gICAgICAuLi5mbnMsXG4gICAgICBbZmlsZS5zcmNdOiBmaWxlLFxuICAgIH1cbiAgfSwge30pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kQW5kUGFyc2VDb25maWdGaWxlKHVzZXJQcm92aWRlZENvbmZpZ0ZpbGVwYXRoPzogc3RyaW5nKTogUGFydGlhbDxQcmVzdGFDb25maWc+IHtcbiAgaWYgKHVzZXJQcm92aWRlZENvbmZpZ0ZpbGVwYXRoKSB7XG4gICAgcmV0dXJuIHJlcXVpcmVGcmVzaChwYXRoLnJlc29sdmUodXNlclByb3ZpZGVkQ29uZmlnRmlsZXBhdGgpKT8uZGVmYXVsdFxuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gcmVxdWlyZUZyZXNoKHBhdGgucmVzb2x2ZShkZWZhdWx0SlNDb25maWdGaWxlcGF0aCkpPy5kZWZhdWx0XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoZGVmYXVsdEpTQ29uZmlnRmlsZXBhdGgpKSB7XG4gICAgICAgIHRocm93IGVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIHJlcXVpcmVGcmVzaChwYXRoLnJlc29sdmUoZGVmYXVsdFRTQ29uZmlnRmlsZXBhdGgpKT8uZGVmYXVsdFxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoZGVmYXVsdFRTQ29uZmlnRmlsZXBhdGgpKSB7XG4gICAgICAgICAgICB0aHJvdyBlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHt9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlQ29uZmlnKGNvbmZpZ0ZpbGU6IFBhcnRpYWw8UHJlc3RhQ29uZmlnPiwgY2xpQXJnczogUHJlc3RhQ2xpQXJncyA9IHt9KTogUHJlc3RhQ29uZmlnIHtcbiAgLy8gVE9ETyBtYWtlIHN1cmUgY3dkIGlzIGFic29sdXRlXG4gIGNvbnN0IGN3ZCA9IGNvbmZpZ0ZpbGUuY3dkIHx8IHByb2Nlc3MuY3dkKClcblxuICBjb25zdCBtZXJnZWQ6IFByZXN0YUNvbmZpZyA9IHtcbiAgICBjd2QsXG4gICAgZmlsZXM6IGNvbmZpZ0ZpbGUuZmlsZXMgfHwgW10sIC8vIFRPRE8gd2hlcmUgZG8gd2UgdmFsaWRhdGVcbiAgICBhc3NldHM6IGNvbmZpZ0ZpbGUuYXNzZXRzIHx8ICdwdWJsaWMnLFxuICAgIHBsdWdpbnM6IGNvbmZpZ0ZpbGUucGx1Z2lucyB8fCBbXSxcbiAgICBwb3J0OiBjb25maWdGaWxlLnBvcnQgfHwgNDAwMCxcbiAgICBzZXJ2ZTogY29uZmlnRmlsZS5zZXJ2ZSA/PyB0cnVlLFxuICAgIGRlYnVnOiAhIWNvbmZpZ0ZpbGUuZGVidWcsXG4gICAgX191bnNhZmVfYnVuZGxlX2V2ZXJ5dGhpbmc6IGNvbmZpZ0ZpbGUuX191bnNhZmVfYnVuZGxlX2V2ZXJ5dGhpbmcgPz8gZmFsc2UsXG4gICAgcmF3Q2xpQXJnczogY2xpQXJncyxcbiAgfVxuXG4gIC8qKlxuICAgKiBPdmVycmlkZSBjb25maWcgZmlsZSBvcHRpb25zIHdpdGggQ0xJXG4gICAqL1xuICBpZiAoY2xpQXJncy5fPy5sZW5ndGgpIG1lcmdlZC5maWxlcyA9IGNsaUFyZ3MuX1xuICBpZiAoY2xpQXJncy5hc3NldHMpIG1lcmdlZC5hc3NldHMgPSBjbGlBcmdzLmFzc2V0c1xuICBpZiAoY2xpQXJncy5wb3J0KSBtZXJnZWQucG9ydCA9IGNsaUFyZ3MucG9ydFxuICBpZiAoY2xpQXJncy5zZXJ2ZSkgbWVyZ2VkLnNlcnZlID0gY2xpQXJncy5zZXJ2ZSA9PT0gJ3RydWUnXG4gIGlmIChjbGlBcmdzLmRlYnVnKSBtZXJnZWQuZGVidWcgPSBjbGlBcmdzLmRlYnVnID09PSB0cnVlXG5cbiAgLyoqXG4gICAqIFJlc29sdmUgYWJzb2x1dGUgcGF0aHNcbiAgICovXG4gIGlmIChtZXJnZWQuZmlsZXMpIG1lcmdlZC5maWxlcyA9IChbXSBhcyBzdHJpbmdbXSkuY29uY2F0KG1lcmdlZC5maWxlcykubWFwKChwKSA9PiBwYXRoLnJlc29sdmUobWVyZ2VkLmN3ZCwgcCkpXG4gIGlmIChtZXJnZWQuYXNzZXRzKSBtZXJnZWQuYXNzZXRzID0gcGF0aC5yZXNvbHZlKG1lcmdlZC5jd2QsIG1lcmdlZC5hc3NldHMpXG5cbiAgcmV0dXJuIG1lcmdlZFxufVxuXG5leHBvcnQgZnVuY3Rpb24gcGF0aG5hbWVUb0ZpbGUocGF0aG5hbWU6IHN0cmluZywgZXh0ID0gJ2h0bWwnKSB7XG4gIHJldHVybiAhIXBhdGguZXh0bmFtZShwYXRobmFtZSlcbiAgICA/IHBhdGhuYW1lIC8vIGlmIHBhdGggaGFzIGV4dGVuc2lvbiwgdXNlIGl0XG4gICAgOiBleHQgPT09ICdodG1sJ1xuICAgID8gYCR7cGF0aG5hbWV9L2luZGV4Lmh0bWxgIC8vIGlmIEhUTUwgaXMgaW5mZXJyZWQsIGNyZWF0ZSBpbmRleFxuICAgIDogYCR7cGF0aG5hbWV9LiR7ZXh0fWAgLy8gYW55dGhpbmcgYnV0IEhUTUwgd2lsbCBuZWVkIGFuIGV4dGVuc2lvbiwgb3RoZXJ3aXNlIGJyb3dzZXJzIHdpbGwgcmVuZGVyIGFzIHRleHRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1pbWVUeXBlKHJlc3BvbnNlOiBMYW1iZGFSZXNwb25zZSkge1xuICBjb25zdCB0eXBlID0gKHJlc3BvbnNlPy5oZWFkZXJzIHx8IHt9KVsnY29udGVudC10eXBlJ11cbiAgcmV0dXJuIG1pbWUuZXh0ZW5zaW9uKHR5cGUgYXMgc3RyaW5nKSB8fCAnaHRtbCdcbn1cblxuLyoqXG4gKiBMb2FkcyB0aGUgX3NvdXJjZV8gZmlsZSwgbm90IHRoZSBidWlsdCBmaWxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2FkU291cmNlRnVuY3Rpb25GaWxlRnJvbU1hbmlmZXN0KFxuICB1cmw6IHN0cmluZyxcbiAgbWFuaWZlc3Q6IE1hbmlmZXN0XG4pOiB7XG4gIGZpbGVwYXRoOiBzdHJpbmdcbiAgZXhwb3J0czogUHJlc3RhRnVuY3Rpb25GaWxlXG59IHtcbiAgY29uc3QgcHJlc3RhRmlsZSA9IE9iamVjdC5lbnRyaWVzKG1hbmlmZXN0LmZ1bmN0aW9ucylcbiAgICAubWFwKChbZmlsZXBhdGgsIHsgcm91dGUgfV0pID0+ICh7XG4gICAgICBtYXRjaGVyOiB0b1JlZ0V4cChyb3V0ZSksXG4gICAgICBmaWxlOiBmaWxlcGF0aCxcbiAgICB9KSlcbiAgICAuZmlsdGVyKCh7IG1hdGNoZXIgfSkgPT4ge1xuICAgICAgcmV0dXJuIG1hdGNoZXIucGF0dGVybi50ZXN0KHVybC5zcGxpdCgnPycpWzBdKVxuICAgIH0pXG4gICAgLm1hcCgoeyBmaWxlIH0pID0+IGZpbGUpWzBdXG5cbiAgcmV0dXJuIHtcbiAgICBmaWxlcGF0aDogcHJlc3RhRmlsZSxcbiAgICBleHBvcnRzOiBwcmVzdGFGaWxlID8gcmVxdWlyZUZyZXNoKHByZXN0YUZpbGUpIDogdW5kZWZpbmVkLFxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBQcmVzdGEge1xuICBjd2Q6IHN0cmluZyA9IHByb2Nlc3MuY3dkKClcblxuICAvKipcbiAgICogRnVsbCBjb25maWcsIHdpdGggQ0xJIGFyZ3VtZW50cyBtZXJnZWQgaW5cbiAgICovXG4gIGNvbmZpZzogUHJlc3RhQ29uZmlnXG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgaW4gcHJvZHVjdGlvbiBvciBkZXZlbG9wbWVudFxuICAgKi9cbiAgbW9kZTogTW9kZSA9IE1vZGUuRGV2XG5cbiAgLyoqXG4gICAqIFRoZSBwb3J0IHByZXN0YSB3aWxsIHNlcnZlIGZpbGVzIGZyb20gaW4gZGV2IG1vZGVcbiAgICovXG4gIHBvcnQ6IG51bWJlclxuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gb3B0aW9uIHRvIG91dHB1dCBkZWJ1ZyBsb2dzIGR1cmluZyBkZXYgKGRlZmF1bHQgYGZhbHNlYClcbiAgICovXG4gIGRlYnVnID0gZmFsc2VcblxuICAvKipcbiAgICogT3V0cHV0IGRpcmVjdG9yeSBmb3Igc3RhdGljIGFzc2V0cyBhbmQgZ2VuZXJhdGVkIGZpbGVzXG4gICAqL1xuICBzdGF0aWNPdXRwdXREaXI6IHN0cmluZ1xuXG4gIC8qKlxuICAgKiBPdXRwdXQgZGlyZWN0b3J5IGZvciBzZXJ2ZXJsZXNzIGZ1bmN0aW9ucy4gVGhpcyBpcyBwcm9iYWJseSBzZXBhcmF0ZSBmcm9tXG4gICAqIHdoZXJlIGFkYXB0ZXJzIG91dHB1dCBmaWxlcy5cbiAgICovXG4gIGZ1bmN0aW9uc091dHB1dERpcjogc3RyaW5nXG5cbiAgLyoqXG4gICAqIEhpZGRlbiAucHJlc3RhIGRpciBmb3IgaW50ZXJuYWwgZmlsZXNcbiAgICovXG4gIHByZXN0YU91dHB1dERpcjogc3RyaW5nXG5cbiAgLyoqXG4gICAqIEZpbGVwYXRoIHRvIG91dHB1dCBidWlsZCBtYW5pZmVzdCB0bywgd2l0aGluIGBjb25maWcub3V0cHV0YCBkaXJlY3RvcnlcbiAgICovXG4gIG1hbmlmZXN0RmlsZXBhdGg6IHN0cmluZ1xuXG4gIC8qKlxuICAgKiBGdWxsIGJ1aWxkIG1hbmlmZXN0LiBTaG91bGQgYmUga2VwdCB1cCB0byBkYXRlIGFzIGZpbGVzIGFyZSBhZGRlZC9yZW1vdmVkL2J1aWx0LlxuICAgKi9cbiAgbWFuaWZlc3Q6IE1hbmlmZXN0ID0ge1xuICAgIHN0YXRpY3M6IHt9LFxuICAgIGZ1bmN0aW9uczoge30sXG4gIH1cblxuICAvKipcbiAgICogQWxsIHdhdGNoZWQgZmlsZXMsIGNvbXB1dGVkIGZyb20gYGNvbmZpZy5maWxlc2Agb3IgQ0xJIGFyZ3MuXG4gICAqL1xuICBmaWxlczogc3RyaW5nW10gPSBbXVxuXG4gIC8qKlxuICAgKiBFdmVudCBlbWl0dGVycyBmb3IgYm90aCBpbnRlcm5hbCBldmVudHMgYW5kIGV4dGVybmFsIGV2ZW50cyBjb25zdW1lZCBieVxuICAgKiB1c2VycyBhbmQgcGx1Z2luc1xuICAgKi9cbiAgZXZlbnRzID0ge1xuICAgIGludGVybmFsOiBzbWl0dGVyPEludGVybmFsRXZlbnRzPigpLFxuICAgIGV4dGVybmFsOiBzbWl0dGVyPEV4dGVybmFsRXZlbnRzPigpLFxuICB9XG5cbiAgLyoqXG4gICAqIDxzY3JpcHQ+IHRhZyBhZGRlZCB0byBhbGwgSFRNTCByZXNwb25zZXMsIGRlcGVuZHMgb24gYHRoaXMuY29uZmlnLnBvcnRgXG4gICAqL1xuICBsaXZlUmVsb2FkU2NyaXB0ID0gJydcblxuICBwbHVnaW5zOiBQbHVnaW5JbnRlcmZhY2VbXVxuXG4gIGxvZ2dlcjogTG9nZ2VyXG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBQYXJ0aWFsPFByZXN0YUNvbmZpZz4pIHtcbiAgICB0aGlzLmN3ZCA9IGNvbmZpZy5jd2QgfHwgcHJvY2Vzcy5jd2QoKVxuXG4gICAgZG90ZW52KHsgcGF0aDogcGF0aC5qb2luKHRoaXMuY3dkLCAnLmVudicpIH0pXG4gICAgYWRkQWxpYXNlcyh7ICdAJzogdGhpcy5jd2QgfSlcblxuICAgIC8vIG1lcmdlIGRlZmF1bHRzIGFnYWluIGluIGNhc2Ugb2YgcHJvZ3JhbW1hdGljIHVzYWdlIGFuZCBwYXJ0aWFsIG9wdGlvbnNcbiAgICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlnKGNvbmZpZylcbiAgICB0aGlzLmRlYnVnID0gISF0aGlzLmNvbmZpZy5kZWJ1Z1xuICAgIHRoaXMubG9nZ2VyID0ge1xuICAgICAgZGVidWc6IChtZXNzYWdlLCBtZXRhZGF0YSkgPT4gdGhpcy5fbG9nKCdkZWJ1ZycsIG1lc3NhZ2UsIG1ldGFkYXRhKSxcbiAgICAgIGluZm86IChtZXNzYWdlLCBtZXRhZGF0YSkgPT4gdGhpcy5fbG9nKCdpbmZvJywgbWVzc2FnZSwgbWV0YWRhdGEpLFxuICAgICAgd2FybjogKG1lc3NhZ2UsIG1ldGFkYXRhKSA9PiB0aGlzLl9sb2coJ3dhcm4nLCBtZXNzYWdlLCBtZXRhZGF0YSksXG4gICAgICBlcnJvcjogKGVycm9yLCBtZXRhZGF0YSkgPT4gdGhpcy5fbG9nKCdlcnJvcicsIGVycm9yLCBtZXRhZGF0YSksXG4gICAgfVxuXG4gICAgdGhpcy5sb2dnZXIuZGVidWcoYGluaXRpYWxpemVkIHdpdGggY29uZmlnICR7SlNPTi5zdHJpbmdpZnkoY29uZmlnLCBudWxsLCAnICAnKX1gKVxuICB9XG5cbiAgLyoqXG4gICAqIEJ1aWxkIGFsbCBmaWxlcyBhbmQgY29weSBzdGF0aWMgYXNzZXRzIHRvIGBjb25maWcub3V0cHV0YC5cbiAgICovXG4gIGFzeW5jIGJ1aWxkKCkge1xuICAgIHRoaXMubW9kZSA9IE1vZGUuQnVpbGRcblxuICAgIHRoaXMuX2luaXQoKVxuXG4gICAgaWYgKCF0aGlzLmZpbGVzLmxlbmd0aCkge1xuICAgICAgdGhpcy5sb2dnZXIud2Fybihgbm8gZmlsZXMgd2VyZSBmb3VuZCwgbm90aGluZyB0byBidWlsZGApXG5cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHRpbWUgPSB0aW1lcigpXG4gICAgY29uc3QgcGtnID0gcmVxdWlyZShwYXRoLmpvaW4odGhpcy5jd2QsICdwYWNrYWdlLmpzb24nKSlcblxuICAgIC8vIGNsZWFuIHNsYXRlXG4gICAgYXdhaXQgZnMucmVtb3ZlKHRoaXMuc3RhdGljT3V0cHV0RGlyKSAvLyBjb3VsZCBiZSBvdmVycmlkZGVuIGJ5IGEgcGx1Z2luXG4gICAgYXdhaXQgZnMucmVtb3ZlKHRoaXMuZnVuY3Rpb25zT3V0cHV0RGlyKSAvLyBjb3VsZCBiZSBvdmVycmlkZGVuIGJ5IGEgcGx1Z2luXG5cbiAgICAvLyBjb3B5IHN0YXRpYyBhc3NldHNcbiAgICBpZiAoZnMuZXhpc3RzU3luYyh0aGlzLmNvbmZpZy5hc3NldHMpKSBhd2FpdCBmcy5jb3B5KHRoaXMuY29uZmlnLmFzc2V0cywgdGhpcy5zdGF0aWNPdXRwdXREaXIpXG5cbiAgICAvLyBidWlsZCBhbGwgZmlsZXMsIGdlbmVyYXRlIG1hbmlmZXNldFxuICAgIGF3YWl0IHRoaXMuYnVpbGRGaWxlcyh0aGlzLmZpbGVzKVxuXG4gICAgLy8gdXNlIG1hbmlmZXN0IHRvIGNvbXBpbGUgcHJvZHVjdGlvbiBzZXJ2ZXJsZXNzIGZ1bmN0aW9uc1xuICAgIGF3YWl0IGVzYnVpbGQoe1xuICAgICAgZW50cnlQb2ludHM6IE9iamVjdC52YWx1ZXModGhpcy5tYW5pZmVzdC5mdW5jdGlvbnMpLm1hcCgoeyBkZXN0IH0pID0+IGRlc3QpLFxuICAgICAgb3V0ZGlyOiB0aGlzLmZ1bmN0aW9uc091dHB1dERpcixcbiAgICAgIHBsYXRmb3JtOiAnbm9kZScsXG4gICAgICB0YXJnZXQ6IFsnbm9kZTEyJ10sXG4gICAgICBtaW5pZnk6IHRydWUsXG4gICAgICBhbGxvd092ZXJ3cml0ZTogdHJ1ZSxcbiAgICAgIGV4dGVybmFsOiB0aGlzLmNvbmZpZy5fX3Vuc2FmZV9idW5kbGVfZXZlcnl0aGluZyA/IFtdIDogT2JqZWN0LmtleXMocGtnLmRlcGVuZGVuY2llcyB8fCB7fSksXG4gICAgICBidW5kbGU6IHRydWUsXG4gICAgICBkZWZpbmU6IHtcbiAgICAgICAgJ3Byb2Nlc3MuZW52LlBSRVNUQV9TRVJWRVJMRVNTX1JVTlRJTUUnOiAndHJ1ZScsXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICB0aGlzLmxvZ2dlci5pbmZvKGBwcmVzdGEgYnVpbGQgY29tcGxldGVgLCB7IGR1cmF0aW9uOiB0aW1lKCkgfSlcblxuICAgIHRoaXMuZXZlbnRzLmV4dGVybmFsLmVtaXQoJ2J1aWxkQ29tcGxldGUnKVxuICB9XG5cbiAgYXN5bmMgZGV2KCkge1xuICAgIHRoaXMubW9kZSA9IE1vZGUuRGV2XG5cbiAgICB0aGlzLl9pbml0KClcblxuICAgIGlmICh0aGlzLmNvbmZpZy5zZXJ2ZSkge1xuICAgICAgYXdhaXQgdGhpcy5fZ2V0UG9ydCgpXG4gICAgICB0aGlzLmxpdmVSZWxvYWRTY3JpcHQgPSB0aGlzLmNvbmZpZy5zZXJ2ZSA/IGNyZWF0ZUxpdmVSZWxvYWRTY3JpcHQoeyBwb3J0OiB0aGlzLnBvcnQgfSkgOiAnJ1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlYm91bmNlIHJlc3RhcnRzIGlmIG11bHRpcGxlIGFyZSB0cmlnZ2VyZWQgaW4gcXVpY2sgc3VjY2Vzc2lvblxuICAgICAqL1xuICAgIGxldCByZXN0YXJ0aW5nID0gZmFsc2VcblxuICAgIC8qKlxuICAgICAqIFRoZSBtYWluIGRldiBwcm9jZXNzLlxuICAgICAqL1xuICAgIGxldCB3YXRjaGVyID0gYXdhaXQgdGhpcy5faW5pdERldigpXG5cbiAgICAvKipcbiAgICAgKiBMb2NhbCBmdW5jdGlvbiB0byBoYW5kbGUgcmVzZXR0aW5nIGV2ZXJ5dGhpbmcgYWZ0ZXIgYSBjb25maWcgZmlsZSBjaGFuZ2UuXG4gICAgICogQWxzbyBjYWxsZWQgcHJvZ3JhbW1hdGljYWxseSBmcm9tIHBsdWdpbnMgd2hlbiB0aGVpciBjb25maWdzIGNoYW5nZS5cbiAgICAgKi9cbiAgICBjb25zdCByZXN0YXJ0ID0gYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gZGVib3VuY2VcbiAgICAgIGlmIChyZXN0YXJ0aW5nKSByZXR1cm5cbiAgICAgIHJlc3RhcnRpbmcgPSB0cnVlXG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIGRlc3Ryb3kgb2xkIHdhdGNoIHByb2Nlc3NcbiAgICAgICAgYXdhaXQgd2F0Y2hlci5jbGVhbnVwKClcblxuICAgICAgICBpZiAoIXRoaXMuZGVidWcpIGNvbnNvbGUuY2xlYXIoKVxuXG4gICAgICAgIHRoaXMubG9nZ2VyLmluZm8oYFx1MjY3QSByZXN0YXJ0aW5nYClcblxuICAgICAgICAvLyByZXNldCBjb25maWcgaW4gY2FzZSBvZiBjaGFuZ2VzXG4gICAgICAgIHRoaXMuY29uZmlnID0gbWVyZ2VDb25maWcoZmluZEFuZFBhcnNlQ29uZmlnRmlsZSh0aGlzLmNvbmZpZy5yYXdDbGlBcmdzLmNvbmZpZyksIHRoaXMuY29uZmlnLnJhd0NsaUFyZ3MpXG5cbiAgICAgICAgLy8gcnVuIF9pbml0IGFnYWluIHRvIHJlY29tcHV0ZSBpbnN0YW5jZSB2YWx1ZXMgYW5kIGNsZWFudXAgcGx1Z2luc1xuICAgICAgICB0aGlzLl9pbml0KClcblxuICAgICAgICAvLyBzdGFydCBhIG5ldyB3YXRjaCBwcm9jZXNzXG4gICAgICAgIHdhdGNoZXIgPSBhd2FpdCB0aGlzLl9pbml0RGV2KClcblxuICAgICAgICB0aGlzLmV2ZW50cy5pbnRlcm5hbC5lbWl0KCdkZXZTZXJ2ZXJSZXN0YXJ0ZWQnKVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihlIGFzIEVycm9yKVxuICAgICAgfVxuXG4gICAgICAvLyBkb24ndCBmb3JnZXQgdG8gcmVzZXQhXG4gICAgICByZXN0YXJ0aW5nID0gZmFsc2VcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXYXRjaGVzIGZvciBjb25maWcgZmlsZXMgY2hhbmdlcyBhbmQgcmVzdGFydHMgdGhlIHdhdGNoIHByb2Nlc3Mgb24gY2hhbmdlcy5cbiAgICAgKi9cbiAgICBjb25zdCBjb25maWdXYXRjaGVyID0gY2hva2lkYXJcbiAgICAgIC53YXRjaChcbiAgICAgICAgW1xuICAgICAgICAgIHRoaXMuY29uZmlnLnJhd0NsaUFyZ3MuY29uZmlnICYmIHBhdGgucmVzb2x2ZSh0aGlzLmNvbmZpZy5yYXdDbGlBcmdzLmNvbmZpZyksXG4gICAgICAgICAgZGVmYXVsdEpTQ29uZmlnRmlsZXBhdGgsXG4gICAgICAgICAgZGVmYXVsdFRTQ29uZmlnRmlsZXBhdGgsXG4gICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pIGFzIHN0cmluZ1tdLFxuICAgICAgICB7IGlnbm9yZUluaXRpYWw6IHRydWUgfVxuICAgICAgKVxuICAgICAgLm9uKCdhbGwnLCByZXN0YXJ0KVxuXG4gICAgdGhpcy5ldmVudHMuaW50ZXJuYWwub24oJ3JlcXVlc3RSZXN0YXJ0RGV2U2VydmVyJywgcmVzdGFydClcblxuICAgIHJldHVybiB7XG4gICAgICAvKipcbiAgICAgICAqIEVuZHMgdGhlIHdhdGNoIHByb2Nlc3MuIE1vc3RseSB1c2VmdWwgZm9yIGludGVybmFsIHRlc3RpbmcuXG4gICAgICAgKi9cbiAgICAgIGFzeW5jIGNsZWFudXAoKSB7XG4gICAgICAgIGF3YWl0IHdhdGNoZXIuY2xlYW51cCgpXG4gICAgICAgIGF3YWl0IGNvbmZpZ1dhdGNoZXIuY2xvc2UoKVxuICAgICAgfSxcbiAgICB9XG4gIH1cblxuICBzZXJ2ZSgpIHtcbiAgICB0aGlzLm1vZGUgPSBNb2RlLlNlcnZlXG4gICAgdGhpcy5faW5pdCgpXG4gICAgdGhpcy5fc2VydmUoKVxuICB9XG5cbiAgLyoqXG4gICAqIFJlc3RhcnRzIHRoZSBlbnRpcmUgZGV2IHByb2Nlc3MgYW5kIHJlYnVpbGRzICphbGwqIGZpbGVzLiBVc3VhbGx5IHVzZWQgYnlcbiAgICogcGx1Z2lucyBhZnRlciBhIGNyaXRpY2FsIGNvbmZpZ3VyYXRpb24gY2hhbmdlLiAqVXNlIHdpdGggY2F1dGlvbi4qXG4gICAqL1xuICByZXN0YXJ0RGV2U2VydmVyKCkge1xuICAgIGlmICh0aGlzLm1vZGUgIT09IE1vZGUuRGV2KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFJlcXVlc3RlZCBhIGRldiBzZXJ2ZXIgcmVzdGFydCBpbiAke3RoaXMubW9kZX0gbW9kZWApXG4gICAgfVxuXG4gICAgdGhpcy5ldmVudHMuaW50ZXJuYWwuZW1pdCgncmVxdWVzdFJlc3RhcnREZXZTZXJ2ZXInKVxuICB9XG5cbiAgLyoqXG4gICAqIExvYWRzIGEgbW9kdWxlIGZyb20gZmlsZXBhdGggYW5kIGdlbmVyYXRlcyBzdGF0aWMgZmlsZXMgYW5kIGZ1bmN0aW9uc1xuICAgKi9cbiAgYXN5bmMgYnVpbGRGaWxlKGZpbGVwYXRoOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyByb3V0ZSwgZ2V0U3RhdGljUGF0aHMsIGhhbmRsZXIgfSA9IHJlcXVpcmUoZmlsZXBhdGgpIGFzIFByZXN0YUZpbGVcblxuICAgICAgaWYgKGdldFN0YXRpY1BhdGhzKSB7XG4gICAgICAgIGNvbnN0IHN0YXRpY1BhdGhzID0gYXdhaXQgZ2V0U3RhdGljUGF0aHMoKSAvLyB1cmxzIHRvIHJlbmRlclxuICAgICAgICBjb25zdCBidWlsdEZpbGVzID0gW10gLy8gbmV3bHkgYnVpbHQgZmlsZXNcbiAgICAgICAgY29uc3QgcHJldkJ1aWx0RmlsZXMgPSB0aGlzLm1hbmlmZXN0LnN0YXRpY3NbZmlsZXBhdGhdIHx8IFtdIC8vIGVtcHR5IG9uIGZpcnN0IHBhc3NcblxuICAgICAgICAvLyBpZiBubyBwYXRocyBhcmUgcmV0dXJuZWQsIGNsZWFuIHVwIG9sZCBwYXRocyBhbmQgbWFuaWZlc3QgZW50cnlcbiAgICAgICAgaWYgKCFzdGF0aWNQYXRocy5sZW5ndGgpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHByZXZCdWlsdEZpbGUgb2YgcHJldkJ1aWx0RmlsZXMpIHtcbiAgICAgICAgICAgIGF3YWl0IGZzLnJlbW92ZShwcmV2QnVpbHRGaWxlKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMubWFuaWZlc3Quc3RhdGljc1tmaWxlcGF0aF0gPSBbXVxuXG4gICAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoYG5vIGJ1aWx0IGZpbGVzIGRldGVjdGVkLCByZW1vdmluZyBhbGwgcHJldmlvdXMgYXJ0aWZhY3RzIGZvciAke2ZpbGVwYXRofWApXG5cbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgdXJsIG9mIHN0YXRpY1BhdGhzKSB7XG4gICAgICAgICAgY29uc3QgdGltZSA9IHRpbWVyKClcblxuICAgICAgICAgIGNvbnN0IGV2ZW50ID0gbm9ybWFsaXplRXZlbnQoe1xuICAgICAgICAgICAgcGF0aDogdXJsLFxuICAgICAgICAgICAgcGF0aFBhcmFtZXRlcnM6IHJvdXRlID8gcGFyc2VQYXRoUGFyYW1ldGVycyh1cmwsIHJvdXRlKSA6IHt9LFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IG5vcm1hbGl6ZVJlc3BvbnNlKGF3YWl0IGhhbmRsZXIoZXZlbnQsIHt9IGFzIENvbnRleHQpKVxuICAgICAgICAgIGNvbnN0IHR5cGUgPSAocmVzcG9uc2U/LmhlYWRlcnMgfHwge30pWydjb250ZW50LXR5cGUnXSAvLyBpbnRlbGxpZ2VudGx5IGluZmVyIHR5cGVcbiAgICAgICAgICBjb25zdCBleHQgPSBtaW1lLmV4dGVuc2lvbih0eXBlIGFzIHN0cmluZykgfHwgJ2h0bWwnIC8vIGRlZmF1bHRzIHRvIGh0bWxcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IHBhdGhuYW1lVG9GaWxlKHVybCwgZXh0KVxuICAgICAgICAgIGNvbnN0IGh0bWwgPSByZXNwb25zZS5ib2R5XG4gICAgICAgICAgY29uc3Qgb3V0ZmlsZSA9IHBhdGguam9pbih0aGlzLnN0YXRpY091dHB1dERpciwgZmlsZW5hbWUpXG5cbiAgICAgICAgICBmcy5vdXRwdXRGaWxlU3luYyhvdXRmaWxlLCBodG1sLCAndXRmLTgnKVxuICAgICAgICAgIGJ1aWx0RmlsZXMucHVzaChvdXRmaWxlKVxuXG4gICAgICAgICAgdGhpcy5sb2dnZXIuaW5mbyhgXHUyNUNGICR7dXJsfWAsIHsgZHVyYXRpb246IHRpbWUoKSB9KVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gZGlmZiBwcmV2aW91cyBidWlsdCBmaWxlcyB3aXRoIG5ldyBmaWxlcyBhbmQgcmVtb3ZlIHN0YWxlXG4gICAgICAgIGZvciAoY29uc3QgcHJldkJ1aWx0RmlsZSBvZiBwcmV2QnVpbHRGaWxlcykge1xuICAgICAgICAgIGlmICghYnVpbHRGaWxlcy5pbmNsdWRlcyhwcmV2QnVpbHRGaWxlKSkge1xuICAgICAgICAgICAgYXdhaXQgZnMucmVtb3ZlKHByZXZCdWlsdEZpbGUpXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgZGV0ZWN0ZWQgcmVtb3ZlZCBmaWxlLCBjbGVhbmluZyB1cCAke2ZpbGVwYXRofWApXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gb3ZlcndyaXRlIGV2ZXJ5IHRpbWUgd2l0aCBuZXcgZmlsZXNcbiAgICAgICAgdGhpcy5tYW5pZmVzdC5zdGF0aWNzW2ZpbGVwYXRoXSA9IGJ1aWx0RmlsZXNcbiAgICAgIH1cblxuICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgIGNvbnN0IHRpbWUgPSB0aW1lcigpXG4gICAgICAgIGNvbnN0IHNsdWcgPSBzbHVnaWZ5KGZpbGVwYXRoLCB0aGlzLmN3ZCkgLy8gcHJldmVudHMgbmFtZSBjb2xsaXNpb25zXG4gICAgICAgIC8vIGhhc2ggaW4gcHJvZCBmb3IgY2FjaGUgYnVzdGluZ1xuICAgICAgICBsZXQgb3V0ZmlsZSA9ICcnXG5cbiAgICAgICAgLy8gaW4gZGV2IG1vZGUgd2UganVzdCBzZXJ2ZSB1c2luZyB0aGUgc291cmNlIGZpbGVcbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gTW9kZS5CdWlsZCkge1xuICAgICAgICAgIG91dGZpbGUgPSBwYXRoLmpvaW4oXG4gICAgICAgICAgICB0aGlzLmZ1bmN0aW9uc091dHB1dERpcixcbiAgICAgICAgICAgIHRoaXMubW9kZSA9PT0gTW9kZS5CdWlsZFxuICAgICAgICAgICAgICA/IC8vIFRPRE8gZG8gSSBuZWVkIHRvIGhhc2ggdGhpcyBzaW5jZSBpdCdzIHNsdWdpZmllZCBhbmQgcGxhdGZvcm1zIGRvIHRoZWlyIG93biBjYWNoaW5nP1xuICAgICAgICAgICAgICAgIHNsdWcgKyAnLScgKyBoYXNoQ29udGVudChmcy5yZWFkRmlsZVN5bmMoZmlsZXBhdGgsICd1dGY4JykpICsgJy5qcydcbiAgICAgICAgICAgICAgOiBzbHVnICsgJy5qcydcbiAgICAgICAgICApXG5cbiAgICAgICAgICBmcy5vdXRwdXRGaWxlU3luYyhcbiAgICAgICAgICAgIG91dGZpbGUsXG4gICAgICAgICAgICBgaW1wb3J0IHsgd3JhcEhhbmRsZXIgfSBmcm9tICdwcmVzdGEvcnVudGltZS93cmFwSGFuZGxlcic7XG5pbXBvcnQgKiBhcyBmaWxlIGZyb20gJyR7ZmlsZXBhdGh9JztcbmNvbnN0IG1vZCA9IE9iamVjdC5hc3NpZ24oeyBjb25maWc6IHt9IH0sIGZpbGUpXG5leHBvcnQgY29uc3Qgcm91dGUgPSBtb2Qucm91dGVcbmV4cG9ydCBjb25zdCBjb25maWcgPSBtb2QuY29uZmlnXG5leHBvcnQgY29uc3QgaGFuZGxlciA9IHdyYXBIYW5kbGVyKG1vZClgXG4gICAgICAgICAgKVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gc29ydCBieSByb3V0ZSBwcmlvcml0eSBhbmQgYWdhaW4sIGFsd2F5cyBvdmVyd3JpdGVcbiAgICAgICAgdGhpcy5tYW5pZmVzdC5mdW5jdGlvbnMgPSBzb3J0TWFuaWZlc3RGdW5jdGlvbnMoe1xuICAgICAgICAgIC4uLnRoaXMubWFuaWZlc3QuZnVuY3Rpb25zLFxuICAgICAgICAgIFtmaWxlcGF0aF06IHtcbiAgICAgICAgICAgIHJvdXRlLFxuICAgICAgICAgICAgc3JjOiBmaWxlcGF0aCxcbiAgICAgICAgICAgIGRlc3Q6IG91dGZpbGUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKGBcdTAzQkIgJHtyb3V0ZX1gLCB7IGR1cmF0aW9uOiB0aW1lKCkgfSlcblxuICAgICAgICAvLyBUT0RPIGRpZmYgYW5kIHJlbW92ZSBvbGQgbGFtYmRhc1xuICAgICAgfVxuXG4gICAgICAvLyBjb21taXQgdG8gZmlsZSBmb3IgcmVmZXJlbmNlIGJ5IHBsdWdpbnNcbiAgICAgIHRoaXMuX2NvbW1pdE1hbmlmZXN0VG9GaWxlKClcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihlIGFzIEVycm9yKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBXcmFwcGVyIGFyb3VuZCBgdGhpcy5idWlsZEZpbGVgXG4gICAqL1xuICBhc3luYyBidWlsZEZpbGVzKGZpbGVwYXRoczogc3RyaW5nW10pIHtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChmaWxlcGF0aHMubWFwKChmaWxlKSA9PiB0aGlzLmJ1aWxkRmlsZShmaWxlKSkpXG4gIH1cblxuICAvKipcbiAgICogQ2FsbGVkIGR1cmluZyBzdGFydC9yZXN0YXJ0LiBSZWZlcmVuY2VzIGB0aGlzLmNvbmZpZ2AgdG8gY29tcHV0ZSBzb21lXG4gICAqIGluc3RhbmNlIHByb3BlcnRpZXMgdGhhdCBhcmUgdXNlZCB0aHJvdWdob3V0IHRoZSBpbnN0YW5jZSBtZXRob2RzIChhbmQgc29cbiAgICogbXVzdCBiZSBjYWxsZWQgYWZ0ZXIgdGhpcy5jb25maWcgaXMgc2V0IG9yIHVwZGF0ZWQpLiBBbHNvIHBhcnNlcyB0aGVcbiAgICogdXNlci1pbnB1dCBmaWxlIGdsb2JzIHRvIGRpc2NvdmVyIHRhcmdldGVkIGZpbGVzIGFuZCBhc3NpZ24gdG9cbiAgICogdGhpcy5maWxlc2AuXG4gICAqL1xuICBwcml2YXRlIF9pbml0KCkge1xuICAgIGlmICh0aGlzLnBsdWdpbnM/Lmxlbmd0aCkge1xuICAgICAgdGhpcy5wbHVnaW5zLmZvckVhY2goKHBsdWdpbikgPT4ge1xuICAgICAgICBpZiAocGx1Z2luLmNsZWFudXApIHtcbiAgICAgICAgICB0aGlzLl9sb2coJ2RlYnVnJywgYGNsZWFuaW5nIHVwICR7cGx1Z2luLm5hbWV9IHBsdWdpbmApXG4gICAgICAgICAgcGx1Z2luLmNsZWFudXAoKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIHRoaXMucHJlc3RhT3V0cHV0RGlyID0gcGF0aC5qb2luKHRoaXMuY3dkLCByb290T3V0cHV0RGlyKVxuICAgIHRoaXMuc3RhdGljT3V0cHV0RGlyID0gcGF0aC5qb2luKHRoaXMuY3dkLCBzdGF0aWNPdXRwdXREaXIpXG4gICAgdGhpcy5mdW5jdGlvbnNPdXRwdXREaXIgPSBwYXRoLmpvaW4odGhpcy5jd2QsIGZ1bmN0aW9uc091dHB1dERpcilcbiAgICB0aGlzLm1hbmlmZXN0RmlsZXBhdGggPSBwYXRoLmpvaW4odGhpcy5wcmVzdGFPdXRwdXREaXIsICdtYW5pZmVzdC5qc29uJylcbiAgICB0aGlzLmZpbGVzID0gKFtdIGFzIHN0cmluZ1tdKVxuICAgICAgLmNvbmNhdCh0aGlzLmNvbmZpZy5maWxlcylcbiAgICAgIC5tYXAoKGZpbGUpID0+IGdsb2JTeW5jKGZpbGUpKVxuICAgICAgLmZsYXQoKVxuICAgICAgLm1hcCgoZmlsZSkgPT4gcGF0aC5yZXNvbHZlKHRoaXMuY3dkLCBmaWxlKSkgLy8gbWFrZSBhYnNvbHV0ZVxuXG4gICAgdGhpcy5wbHVnaW5zID0gdGhpcy5jb25maWcucGx1Z2lucy5tYXAoKHBsdWdpbikgPT4ge1xuICAgICAgY29uc3QgcCA9IHBsdWdpbih7XG4gICAgICAgIG1vZGU6IHRoaXMubW9kZSxcbiAgICAgICAgY3dkOiB0aGlzLmN3ZCxcbiAgICAgICAgZXZlbnRzOiB7IG9uOiB0aGlzLmV2ZW50cy5leHRlcm5hbC5vbiB9LFxuICAgICAgICBsb2dnZXI6IHRoaXMubG9nZ2VyLFxuICAgICAgICBnZXRNYW5pZmVzdDogKCkgPT4gdGhpcy5tYW5pZmVzdCxcbiAgICAgICAgZ2V0T3V0cHV0RGlyOiAoKSA9PiB0aGlzLnByZXN0YU91dHB1dERpcixcbiAgICAgICAgZ2V0U3RhdGljT3V0cHV0RGlyOiAoKSA9PiB0aGlzLnN0YXRpY091dHB1dERpcixcbiAgICAgICAgZ2V0RnVuY3Rpb25zT3V0cHV0RGlyOiAoKSA9PiB0aGlzLmZ1bmN0aW9uc091dHB1dERpcixcbiAgICAgICAgcmVzdGFydERldlNlcnZlcjogdGhpcy5yZXN0YXJ0RGV2U2VydmVyLmJpbmQodGhpcyksXG4gICAgICB9KVxuXG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgJHtwLm5hbWV9IGluaXRpYWxpemVkYClcblxuICAgICAgcmV0dXJuIHBcbiAgICB9KVxuXG4gICAgdGhpcy5sb2dnZXIuZGVidWcoYHByZXN0YSBzdGFydFxcbiR7SlNPTi5zdHJpbmdpZnkodGhpcywgbnVsbCwgJyAgJyl9YClcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgX3NlcnZlKCkge1xuICAgIGlmICh0aGlzLm1vZGUgPT09IE1vZGUuU2VydmUpIGF3YWl0IHRoaXMuX2dldFBvcnQoKVxuXG4gICAgdGhpcy5sb2dnZXIuaW5mbyhgXHUyNkExXHVGRTBFaHR0cDovL2xvY2FsaG9zdDoke3RoaXMucG9ydH1gKVxuXG4gICAgY29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoKHJlcSwgcmVzKSA9PiB0aGlzLl9odHRwU2VydmVySGFuZGxlcihyZXEsIHJlcykpLmxpc3Rlbih0aGlzLnBvcnQpXG4gICAgY29uc3Qgd2Vic29ja2V0ID0gbmV3IFdlYlNvY2tldFNlcnZlcih7IHNlcnZlciB9KVxuICAgIGNvbnN0IHNvY2tldHM6IFNvY2tldFtdID0gW11cblxuICAgIC8vIG9uY2UgYSBicm93c2VyIGNvbm5lY3RzLCB0cmFjayBpdHMgc29ja2V0XG4gICAgc2VydmVyLm9uKCdjb25uZWN0aW9uJywgKHNvY2tldCkgPT4ge1xuICAgICAgc29ja2V0cy5wdXNoKHNvY2tldClcbiAgICAgIHNvY2tldC5vbignY2xvc2UnLCAoKSA9PiBzb2NrZXRzLnNwbGljZShzb2NrZXRzLmluZGV4T2Yoc29ja2V0KSwgMSkpXG4gICAgfSlcblxuICAgIGNvbnN0IHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgcmVmcmVzaGluZyBicm93c2VyYClcbiAgICAgIHdlYnNvY2tldC5jbGllbnRzLmZvckVhY2goKHdzKSA9PiB3cy5zZW5kKCdyZWZyZXNoJykpXG4gICAgfVxuXG4gICAgY29uc3QgbGlzdGVuZXJzID0gW1xuICAgICAgdGhpcy5ldmVudHMuaW50ZXJuYWwub24oJ2RldlNlcnZlclJlc3RhcnRlZCcsICgpID0+IHJlZnJlc2goKSksXG4gICAgICB0aGlzLmV2ZW50cy5pbnRlcm5hbC5vbignZGV2RmlsZUFkZGVkJywgKCkgPT4gcmVmcmVzaCgpKSxcbiAgICAgIHRoaXMuZXZlbnRzLmludGVybmFsLm9uKCdkZXZGaWxlUmVtb3ZlZCcsICgpID0+IHJlZnJlc2goKSksXG4gICAgICB0aGlzLmV2ZW50cy5pbnRlcm5hbC5vbignZGV2RmlsZUNoYW5nZWQnLCAoKSA9PiByZWZyZXNoKCkpLFxuICAgIF1cblxuICAgIHJldHVybiB7XG4gICAgICAvKipcbiAgICAgICAqIFN0b3AgSFRUUCBzZXJ2ZXIgYW5kIGNsb3NlIGFsbCB3ZWJzb2NrZXQgbGlzdGVuZXJzXG4gICAgICAgKi9cbiAgICAgIGNsZWFudXAoKSB7XG4gICAgICAgIC8vIHNvIGp1c3QgYWx3YXlzIHJlc29sdmUgT0tcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCh5KSA9PiB7XG4gICAgICAgICAgbGlzdGVuZXJzLm1hcCgobCkgPT4gbCgpKVxuICAgICAgICAgIHNlcnZlci5jbG9zZSgoKSA9PiB5KDEpKVxuICAgICAgICAgIC8vIHNvY2tldHMgaW5jbHVkZXMgd3Mgc29ja2V0c1xuICAgICAgICAgIHNvY2tldHMuZm9yRWFjaCgod3MpID0+IHdzLmRlc3Ryb3koKSlcbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfbG9nKGxldmVsOiBMb2dMZXZlbCwgbWVzc2FnZTogc3RyaW5nIHwgRXJyb3IsIHsgZHVyYXRpb24gfTogeyBkdXJhdGlvbj86IHN0cmluZyB9ID0ge30pIHtcbiAgICBpZiAoIXRoaXMuZGVidWcgJiYgbGV2ZWwgPT09ICdkZWJ1ZycpIHJldHVyblxuXG4gICAgY29uc3QgY29sb3JzOiB7XG4gICAgICBba2V5IGluIExvZ0xldmVsXTogc3RyaW5nXG4gICAgfSA9IHtcbiAgICAgIGRlYnVnOiAnbWFnZW50YScsXG4gICAgICBpbmZvOiAncmVzZXQnLFxuICAgICAgd2FybjogJ3llbGxvdycsXG4gICAgICBlcnJvcjogJ3JlZCcsXG4gICAgfVxuXG4gICAgY29uc3QgY29sb3IgPSBrbGV1cltjb2xvcnNbbGV2ZWxdIGFzIGtleW9mIEtsZXVyXVxuXG4gICAgY29uc29sZVtsZXZlbF0oXG4gICAgICBba2xldXIuZ3JheSh0aGlzLm1vZGUpLCBjb2xvcihTdHJpbmcobWVzc2FnZSkpLCBkdXJhdGlvbiAmJiBgJHtrbGV1ci5ncmF5KGR1cmF0aW9uKX1gXS5maWx0ZXIoQm9vbGVhbikuam9pbignICcpXG4gICAgKVxuXG4gICAgaWYgKGxldmVsID09PSAnZXJyb3InICYmIG1lc3NhZ2UgaW5zdGFuY2VvZiBFcnJvcikgY29uc29sZS5lcnJvcihtZXNzYWdlKVxuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBtYWluIGRldiBwcm9jZXNzXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIF9pbml0RGV2KCkge1xuICAgIC8qKlxuICAgICAqIFdhdGNoZXIgZm9yICprbm93biogZmlsZXMuIERvZXMgbm90IHBpY2sgdXAgbmV3bHkgYWRkZWQgZmlsZXMsIGJ1dCBkb2VzXG4gICAgICogZGV0ZWN0IHJlbW92YWxzLlxuICAgICAqL1xuICAgIGNvbnN0IGZpbGVXYXRjaGVyID0gY3JlYXRlKHsgYWxpYXM6IHsgJ0AnOiB0aGlzLmN3ZCB9IH0pXG5cbiAgICAvKlxuICAgICAqIFdhdGNoZXMgdGhlIHJhdyBmaWxlIGdsb2JzIHBhc3NlZCB0byB0aGUgQ0xJIG9yIGFzIGBjb25maWcuZmlsZXNgLlxuICAgICAqIENoZWNrcyBvbiBhZGQvY2hhbmdlIHRvIHNlZSBpZiBhIGZpbGUgc2hvdWxkIGJlIHVwZ3JhZGVkIHRvIGEgYSBQcmVzdGFcbiAgICAgKiBzb3VyY2UgZmlsZSwgYW5kIGFkZGVkIHRvIHRoZSBgZmlsZVdhdGNoZXJgLlxuICAgICAqL1xuICAgIGNvbnN0IGdsb2JhbFdhdGNoZXIgPSBjaG9raWRhci53YXRjaCh0aGlzLmN3ZCwge1xuICAgICAgaWdub3JlSW5pdGlhbDogdHJ1ZSxcbiAgICAgIGlnbm9yZWQ6IFt0aGlzLnN0YXRpY091dHB1dERpciwgdGhpcy5mdW5jdGlvbnNPdXRwdXREaXIsIHRoaXMuY29uZmlnLmFzc2V0c10sXG4gICAgfSlcblxuICAgIC8qKlxuICAgICAqIEhUVFAgc2VydmVyXG4gICAgICovXG4gICAgbGV0IHNlcnZlcjogQXdhaXRlZDxSZXR1cm5UeXBlPHR5cGVvZiB0aGlzLl9zZXJ2ZT4+XG5cbiAgICAvKipcbiAgICAgKiBXYXRjaGVzIGZvciBzdGF0aWMgYXNzZXQgY2hhbmdlcyBhbmQgcmVwb3J0cyB0byBjb25uZWN0ZWQgYnJvd3NlcnMgZm9yIGFcbiAgICAgKiByZWZyZXNoXG4gICAgICovXG4gICAgbGV0IHN0YXRpY0Fzc2V0V2F0Y2hlcjogUmV0dXJuVHlwZTx0eXBlb2YgY2hva2lkYXIud2F0Y2g+XG4gICAgaWYgKHRoaXMuY29uZmlnLnNlcnZlKSB7XG4gICAgICBzZXJ2ZXIgPSBhd2FpdCB0aGlzLl9zZXJ2ZSgpXG5cbiAgICAgIHN0YXRpY0Fzc2V0V2F0Y2hlciA9IGNob2tpZGFyLndhdGNoKHRoaXMuY29uZmlnLmFzc2V0cywgeyBpZ25vcmVJbml0aWFsOiB0cnVlIH0pLm9uKCdhbGwnLCAoZXZlbnQsIGZpbGUpID0+IHtcbiAgICAgICAgdGhpcy5sb2dnZXIuZGVidWcoYHN0YXRpYyBhc3NldCAke2ZpbGV9IGNoYW5nZWRgKVxuICAgICAgICB0aGlzLmV2ZW50cy5pbnRlcm5hbC5lbWl0KCdkZXZGaWxlQ2hhbmdlZCcpXG4gICAgICB9KVxuICAgIH1cblxuICAgIGZpbGVXYXRjaGVyLm9uQ2hhbmdlKGFzeW5jIChjaGFuZ2VkKSA9PiB7XG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgZmlsZSAke2NoYW5nZWRbMF19IGNoYW5nZWRgKVxuICAgICAgYXdhaXQgdGhpcy5idWlsZEZpbGVzKGNoYW5nZWQpXG4gICAgICB0aGlzLmV2ZW50cy5pbnRlcm5hbC5lbWl0KCdkZXZGaWxlQ2hhbmdlZCcpXG4gICAgfSlcblxuICAgIGZpbGVXYXRjaGVyLm9uUmVtb3ZlKGFzeW5jIChbaWRdKSA9PiB7XG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgZmlsZSAke2lkfSB3YXMgcmVtb3ZlZGApXG5cbiAgICAgIC8vIHJlbW92ZSBmcm9tIGxvY2FsIGhhc2hcbiAgICAgIHRoaXMuZmlsZXMuc3BsaWNlKHRoaXMuZmlsZXMuaW5kZXhPZihpZCksIDEpXG5cbiAgICAgIC8vIGEgc2luZ2xlIGZpbGUgY2FuIGdlbmVyYXRlIGJvdGggc3RhdGljIGFuZCBkeWFubWljIG91dHB1dHNcbiAgICAgIGNvbnN0IHByZXZCdWlsdFN0YXRpY0ZpbGVzID0gdGhpcy5tYW5pZmVzdC5zdGF0aWNzW2lkXSB8fCBbXVxuICAgICAgY29uc3QgcHJldkJ1aWx0RnVuY3Rpb25zRmlsZXMgPSB0aGlzLm1hbmlmZXN0LmZ1bmN0aW9uc1tpZF1cblxuICAgICAgLy8gcHVzaCBhbGwgcmVtb3ZhbCB0YXNrcyB0byBhbiBhcnJheVxuICAgICAgY29uc3QgcmVtb3ZhbHMgPSBwcmV2QnVpbHRTdGF0aWNGaWxlcy5tYXAoKGYpID0+IGZzLnJlbW92ZShmKSlcbiAgICAgIGlmIChwcmV2QnVpbHRGdW5jdGlvbnNGaWxlcykge1xuICAgICAgICByZW1vdmFscy5wdXNoKGZzLnJlbW92ZShwcmV2QnVpbHRGdW5jdGlvbnNGaWxlcy5kZXN0KSlcbiAgICAgIH1cblxuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocmVtb3ZhbHMpXG5cbiAgICAgIC8vIGNsZWFudXBcbiAgICAgIGRlbGV0ZSB0aGlzLm1hbmlmZXN0LnN0YXRpY3NbaWRdXG4gICAgICBkZWxldGUgdGhpcy5tYW5pZmVzdC5mdW5jdGlvbnNbaWRdXG5cbiAgICAgIHRoaXMuZXZlbnRzLmludGVybmFsLmVtaXQoJ2RldkZpbGVSZW1vdmVkJylcbiAgICB9KVxuXG4gICAgZmlsZVdhdGNoZXIub25FcnJvcigoZSkgPT4ge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IodHlwZW9mIGUgPT09ICdzdHJpbmcnID8gbmV3IEVycm9yKGUpIDogZSlcbiAgICB9KVxuXG4gICAgLy8gYmVnaW4gd2F0Y2hpbmcgZXhpc3RpbmcgZmlsZXNcbiAgICBhd2FpdCBmaWxlV2F0Y2hlci5hZGQodGhpcy5maWxlcylcblxuICAgIGdsb2JhbFdhdGNoZXIub24oJ2FkZCcsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAvLyBzb21lIGVkZ2UgY2FzZXNcbiAgICAgIGlmICghZnMuZXhpc3RzU3luYyhmaWxlKSB8fCBmcy5sc3RhdFN5bmMoZmlsZSkuaXNEaXJlY3RvcnkoKSkgcmV0dXJuXG4gICAgICAvLyBpZ25vcmUgZmlsZXMgdGhhdCBkb24ndCBtYXRjaCBnbG9ic1xuICAgICAgaWYgKCFtYXRjaCh0aGlzLmNvbmZpZy5maWxlcykoZmlsZSkpIHJldHVyblxuICAgICAgLy8gaWdub3JlIGFscmVhZHkgd2F0Y2hlZCBmaWxlc1xuICAgICAgaWYgKHRoaXMuZmlsZXMuaW5jbHVkZXMoZmlsZSkpIHJldHVyblxuXG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgJHtmaWxlfSBhZGRlZGApXG5cbiAgICAgIC8vIG11c3QgYmUgbmV3LCBzdGFydCB3YXRjaGluZ1xuICAgICAgdGhpcy5maWxlcy5wdXNoKGZpbGUpXG4gICAgICBhd2FpdCBmaWxlV2F0Y2hlci5hZGQoZmlsZSlcblxuICAgICAgLy8gYnVpbGQgZm9yIGZpcnN0IHRpbWVcbiAgICAgIGF3YWl0IHRoaXMuYnVpbGRGaWxlKGZpbGUpXG5cbiAgICAgIHRoaXMuZXZlbnRzLmludGVybmFsLmVtaXQoJ2RldkZpbGVBZGRlZCcpXG4gICAgfSlcblxuICAgIC8qKlxuICAgICAqIEltcG9ydGFudDogaWYgd2UgZXZlciByZW1vdmUgaW5pdGlhbCByZW5kZXJpbmcsIHdlIHdpbGwgd2FudCB0b1xuICAgICAqIHJlLWludHJvZHVjZSBcImZpbGUgcHJpbWluZ1wiIHdoZXJlIHdlIHJlcXVpcmUgYWxsIGZpbGVzIGFuZCBzdXJmYWNlIGVycm9yc1xuICAgICAqIG9uIHN0YXJ0dXAuXG4gICAgICovXG4gICAgYXdhaXQgZnMucmVtb3ZlKHRoaXMuc3RhdGljT3V0cHV0RGlyKVxuICAgIGF3YWl0IGZzLnJlbW92ZSh0aGlzLmZ1bmN0aW9uc091dHB1dERpcilcbiAgICBhd2FpdCB0aGlzLmJ1aWxkRmlsZXModGhpcy5maWxlcylcblxuICAgIHJldHVybiB7XG4gICAgICAvKipcbiAgICAgICAqIERlc3Ryb3lzIG1haW4gZGV2IHByb2Nlc3MsIHJlYWRpZXMgZm9yIHN1YnNlcXVlbnQgY2FsbHMuXG4gICAgICAgKi9cbiAgICAgIGFzeW5jIGNsZWFudXAoKSB7XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICAgIFtcbiAgICAgICAgICAgIGZpbGVXYXRjaGVyLmNsb3NlKCksXG4gICAgICAgICAgICBnbG9iYWxXYXRjaGVyLmNsb3NlKCksXG4gICAgICAgICAgICBzdGF0aWNBc3NldFdhdGNoZXIgJiYgc3RhdGljQXNzZXRXYXRjaGVyLmNsb3NlKCksXG4gICAgICAgICAgICBzZXJ2ZXIgJiYgc2VydmVyLmNsZWFudXAoKSxcbiAgICAgICAgICBdLmZpbHRlcihCb29sZWFuKVxuICAgICAgICApXG4gICAgICB9LFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBc3NpZ25zIGB0aGlzLnBvcnRgIGFuZCBtdXN0IGJlIGNhbGxlZCB3aGVuIHN0YXJ0aW5nIGRldiBvciBzZXJ2ZSBtb2Rlc1xuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBfZ2V0UG9ydCgpIHtcbiAgICBjb25zdCBwb3J0ID0gdGhpcy5jb25maWcucG9ydCB8fCA0MDAwXG4gICAgdGhpcy5wb3J0ID0gYXdhaXQgZ2V0UG9ydCh7IHBvcnQgfSlcblxuICAgIGlmICh0aGlzLnBvcnQgIT09IHBvcnQpIHtcbiAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBkZXNpcmVkIHBvcnQgJHtwb3J0fSBub3QgYXZhaWxhYmxlLCBhc3NpZ25pbmcgJHt0aGlzLnBvcnR9YClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29tbWl0cyBgdGhpcy5tYW5pZmVzdGAgdG8gYSBmaWxlIG9uIHN5c3RlbS5cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgX2NvbW1pdE1hbmlmZXN0VG9GaWxlKCkge1xuICAgIHJldHVybiBmcy5vdXRwdXRGaWxlU3luYyh0aGlzLm1hbmlmZXN0RmlsZXBhdGgsIEpTT04uc3RyaW5naWZ5KHRoaXMubWFuaWZlc3QsIG51bGwsICcgICcpKVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBfaHR0cFNlcnZlckhhbmRsZXIocmVxOiBodHRwLkluY29taW5nTWVzc2FnZSwgcmVzOiBodHRwLlNlcnZlclJlc3BvbnNlKSB7XG4gICAgY29uc3QgdGltZSA9IHRpbWVyKClcblxuICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBoYW5kbGluZyAke3JlcS51cmx9YClcblxuICAgIHRoaXMuX2h0dHBUcnlTZXJ2ZUZpbGUocmVxLCByZXMsIGFzeW5jIChoYW5kbGVkKSA9PiB7XG4gICAgICBpZiAoaGFuZGxlZCkge1xuICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKGBcdTI2QTFcdUZFMEUke3JlcS51cmx9ICR7cmVzLnN0YXR1c0NvZGV9YCwgeyBkdXJhdGlvbjogdGltZSgpIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCB0aGlzLl9odHRwVHJ5U2VydmVMYW1iZGEocmVxLCByZXMpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgX2h0dHBUcnlTZXJ2ZUZpbGUocmVxOiBodHRwLkluY29taW5nTWVzc2FnZSwgcmVzOiBodHRwLlNlcnZlclJlc3BvbnNlLCBjYjogKGhhbmRsZWQ6IGJvb2xlYW4pID0+IHZvaWQpIHtcbiAgICBjb25zdCB7IHBhdGhuYW1lIH0gPSBuZXcgVVJMKHJlcS51cmwgYXMgc3RyaW5nLCAnaHR0cHM6Ly9wcmVzdGEuZGV2JylcbiAgICBjb25zdCBjb250ZW50VHlwZSA9IG1pbWUubG9va3VwKHBhdGhuYW1lKSB8fCAndGV4dC9odG1sJ1xuICAgIGNvbnN0IGlzSHRtbCA9IGNvbnRlbnRUeXBlID09PSAndGV4dC9odG1sJ1xuXG4gICAgY29uc3QgYXNzZXRGaWxlcGF0aCA9IHBhdGguam9pbih0aGlzLmNvbmZpZy5hc3NldHMsIHBhdGhuYW1lKVxuICAgIGNvbnN0IHN0YXRpY0ZpbGVwYXRoID0gcGF0aC5qb2luKHRoaXMuc3RhdGljT3V0cHV0RGlyLCBwYXRobmFtZSlcblxuICAgIGxldCBoYW5kbGVkID0gZmFsc2VcblxuICAgIGNvbnN0IGZpbGVwYXRocyA9IFtcbiAgICAgIGFzc2V0RmlsZXBhdGgsXG4gICAgICBzdGF0aWNGaWxlcGF0aCxcbiAgICAgIHBhdGguam9pbihhc3NldEZpbGVwYXRoLCAnaW5kZXguaHRtbCcpLFxuICAgICAgcGF0aC5qb2luKHN0YXRpY0ZpbGVwYXRoLCAnaW5kZXguaHRtbCcpLFxuICAgIF1cblxuICAgIGZvciAoY29uc3QgZmlsZXBhdGggb2YgZmlsZXBhdGhzKSB7XG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgYXR0ZW1wdGluZyB0byBzZXJ2ZSAke2ZpbGVwYXRofSBhcyAke2NvbnRlbnRUeXBlfWApXG5cbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKGZpbGVwYXRoKSkge1xuICAgICAgICBpZiAoZnMuc3RhdFN5bmMoZmlsZXBhdGgpLmlzRGlyZWN0b3J5KCkpIGNvbnRpbnVlXG5cbiAgICAgICAgcmVzLndyaXRlSGVhZCgyMDAsIHsgJ2NvbnRlbnQtdHlwZSc6IGNvbnRlbnRUeXBlIH0pXG5cbiAgICAgICAgaWYgKGlzSHRtbCkge1xuICAgICAgICAgIGxldCBodG1sID0gZnMucmVhZEZpbGVTeW5jKGZpbGVwYXRoLCAndXRmOCcpXG4gICAgICAgICAgaHRtbCArPSB0aGlzLmxpdmVSZWxvYWRTY3JpcHRcbiAgICAgICAgICByZXMuZW5kKGh0bWwpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZnMuY3JlYXRlUmVhZFN0cmVhbShmaWxlcGF0aCkucGlwZShyZXMpXG4gICAgICAgIH1cblxuICAgICAgICBoYW5kbGVkID0gdHJ1ZVxuXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuXG4gICAgY2IoaGFuZGxlZClcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgX2h0dHBUcnlTZXJ2ZUxhbWJkYShyZXE6IGh0dHAuSW5jb21pbmdNZXNzYWdlLCByZXM6IGh0dHAuU2VydmVyUmVzcG9uc2UpIHtcbiAgICBjb25zdCB0aW1lID0gdGltZXIoKVxuXG4gICAgY29uc3QgZXZlbnQgPSBhd2FpdCByZXF1ZXN0VG9FdmVudChyZXEpIC8vIHN0b2NrIEFXUyBFdmVudCBzaGFwZVxuICAgIGNvbnN0IGFjY2VwdCA9IGV2ZW50LmhlYWRlcnMuQWNjZXB0IHx8IGV2ZW50LmhlYWRlcnMuYWNjZXB0XG4gICAgY29uc3QgYWNjZXB0c0pzb24gPSBhY2NlcHQgJiYgYWNjZXB0LmluY2x1ZGVzKCdqc29uJylcblxuICAgIHRoaXMubG9nZ2VyLmRlYnVnKGBoYW5kbGluZyBmdW5jdGlvbiByZXF1ZXN0ICR7ZXZlbnQucGF0aH1gKVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZmlsZXBhdGgsIGV4cG9ydHM6IGZpbGUgfSA9IGxvYWRTb3VyY2VGdW5jdGlvbkZpbGVGcm9tTWFuaWZlc3QoZXZlbnQucGF0aCwgdGhpcy5tYW5pZmVzdClcblxuICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGBcdTI2QTFcdUZFMEUke2V2ZW50LnBhdGh9ICR7NDA0fWAsIHsgZHVyYXRpb246IHRpbWUoKSB9KVxuICAgICAgICBzZW5kU2VydmVybGVzc1Jlc3BvbnNlKHJlcywgeyBzdGF0dXNDb2RlOiA0MDQgfSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGlmICghZmlsZS5oYW5kbGVyKSB0aHJvdyBuZXcgSHR0cEVycm9yKGBmaWxlICR7ZmlsZXBhdGh9IGRvZXMgbm90IGV4cG9ydCBhIFxcYGhhbmRsZXJcXGBgLCA0MDQpXG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgd3JhcEhhbmRsZXIoZmlsZSkoZXZlbnQsIHt9IGFzIENvbnRleHQpXG4gICAgICBjb25zdCByZWRpciA9IHJlc3BvbnNlLnN0YXR1c0NvZGUgPiAyOTkgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8IDM5OVxuICAgICAgY29uc3QgbWltZSA9IHJlZGlyID8gdW5kZWZpbmVkIDogZ2V0TWltZVR5cGUocmVzcG9uc2UpXG5cbiAgICAgIGlmIChtaW1lID09PSAnaHRtbCcpIHtcbiAgICAgICAgcmVzcG9uc2UuYm9keSA9IChyZXNwb25zZS5ib2R5IHx8ICcnKS5zcGxpdCgnPC9ib2R5PicpWzBdICsgdGhpcy5saXZlUmVsb2FkU2NyaXB0XG4gICAgICB9XG5cbiAgICAgIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzLCByZXNwb25zZSlcblxuICAgICAgdGhpcy5sb2dnZXIuaW5mbyhgXHUyNkExXHVGRTBFJHtyZWRpciA/IHJlc3BvbnNlPy5oZWFkZXJzPy5Mb2NhdGlvbiB8fCBldmVudC5wYXRoIDogZXZlbnQucGF0aH0gJHtyZXNwb25zZS5zdGF0dXNDb2RlfWAsIHtcbiAgICAgICAgZHVyYXRpb246IHRpbWUoKSxcbiAgICAgIH0pXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc3QgZXJyb3IgPSBlIGFzIEh0dHBFcnJvclxuICAgICAgY29uc3QgeyBzdGF0dXNDb2RlID0gNTAwIH0gPSBlcnJvclxuXG4gICAgICBpZiAoc3RhdHVzQ29kZSA+IDQ5OSkgdGhpcy5sb2dnZXIuZXJyb3IoZXJyb3IpXG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYWNjZXB0c0pzb25cbiAgICAgICAgPyBzZXJpYWxpemUuanNvbih7XG4gICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLFxuICAgICAgICAgICAgYm9keTogeyBkZXRhaWw6IHN0YXR1cy5tZXNzYWdlW3N0YXR1c0NvZGVdIH0sXG4gICAgICAgICAgfSlcbiAgICAgICAgOiBzZXJpYWxpemUuaHRtbCh7XG4gICAgICAgICAgICBzdGF0dXNDb2RlOiBzdGF0dXNDb2RlLFxuICAgICAgICAgICAgYm9keTogY3JlYXRlRGVmYXVsdEh0bWxSZXNwb25zZSh7IHN0YXR1c0NvZGUgfSksXG4gICAgICAgICAgfSlcblxuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZXJyb3IpXG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihgXHUyNkExXHVGRTBFJHtldmVudC5wYXRofSAke3Jlc3BvbnNlLnN0YXR1c0NvZGV9YCwgeyBkdXJhdGlvbjogdGltZSgpIH0pXG5cbiAgICAgIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzLCByZXNwb25zZSlcbiAgICB9XG4gIH1cbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gcmVxdWlyZUZyZXNoKG1vZDogc3RyaW5nKSB7XG4gIGRlbGV0ZSByZXF1aXJlLmNhY2hlW21vZF1cbiAgcmV0dXJuIHJlcXVpcmUobW9kKVxufVxuIiwgImV4cG9ydCBmdW5jdGlvbiB0aW1lcigpIHtcbiAgY29uc3Qgc3RhcnQgPSBwcm9jZXNzLmhydGltZSgpXG4gIHJldHVybiAoKSA9PiB7XG4gICAgY29uc3QgW3MsIG5hbm9zXSA9IHByb2Nlc3MuaHJ0aW1lKHN0YXJ0KVxuICAgIGNvbnN0IG1zID0gbmFub3MgLyAxMDAwMDAwXG5cbiAgICBpZiAocyA8IDEpIHtcbiAgICAgIHJldHVybiAobXMgPj0gMSA/IG1zLnRvRml4ZWQoMCkgOiBtcy50b0ZpeGVkKDIpKSArICdtcydcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHMgKyAnLicgKyBtcy50b0ZpeGVkKDApICsgJ3MnXG4gICAgfVxuICB9XG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGhhc2hDb250ZW50KGNvbnRlbnQ6IHN0cmluZykge1xuICB2YXIgaCA9IDUzODEsXG4gICAgaSA9IGNvbnRlbnQubGVuZ3RoXG5cbiAgd2hpbGUgKGkpIGggPSAoaCAqIDMzKSBeIGNvbnRlbnQuY2hhckNvZGVBdCgtLWkpXG5cbiAgcmV0dXJuIChoID4+PiAwKS50b1N0cmluZygzNilcbn1cbiIsICJpbXBvcnQgaHR0cCBmcm9tICdodHRwJ1xuLy8gVE9ETyBjYW4gd2UgbWFrZSB0aGlzIGZpbGUgVjggc2FmZT9cbmltcG9ydCB7IHBhcnNlIGFzIHBhcnNlVXJsIH0gZnJvbSAndXJsJ1xuaW1wb3J0IHJhd0JvZHkgZnJvbSAncmF3LWJvZHknXG5pbXBvcnQgbWltZSBmcm9tICdtaW1lLXR5cGVzJ1xuXG5pbXBvcnQgeyBub3JtYWxpemVFdmVudCB9IGZyb20gJy4uL3J1bnRpbWUvbm9ybWFsaXplRXZlbnQnXG5pbXBvcnQgeyBub3JtYWxpemVSZXF1ZXN0SGVhZGVycyB9IGZyb20gJy4uL3J1bnRpbWUvbm9ybWFsaXplUmVxdWVzdEhlYWRlcnMnXG5pbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nUGFyYW1ldGVycyB9IGZyb20gJy4uL3J1bnRpbWUvcGFyc2VRdWVyeVN0cmluZ1BhcmFtZXRlcnMnXG5pbXBvcnQgeyBpc0Jhc2U2NEVuY29kZWRDb250ZW50VHlwZSB9IGZyb20gJy4uL3J1bnRpbWUvaXNCYXNlNjRFbmNvZGVkQ29udGVudFR5cGUnXG5pbXBvcnQgeyBFdmVudCB9IGZyb20gJy4uLydcblxuLyoqXG4gKiBVc2VkIGludGVybmFsbHkuIENvbnZlcnRzIGEgYGh0dHAuSW5jb21pbmdNZXNzYWdlYCB0byBhIEFXUyBMYW1iZGEgZmxhdm9yZWRcbiAqIGBFdmVudGAgb2JqZWN0LiBUaGlzIG1ldGhvZCBvbmx5IGhhcyBhY2Nlc3MgdG8gdGhlIGluY29taW5nIG1lc3NhZ2UsIHNvIGl0XG4gKiBjYW4ndCBwb3B1bGF0ZSBhbGwgYEV2ZW50YCBwcm9wZXJ0aWVzLCBsaWtlIGBwYXRoUGFyYW1ldGVyc2AuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1ZXN0VG9FdmVudChyZXE6IGh0dHAuSW5jb21pbmdNZXNzYWdlKTogUHJvbWlzZTxFdmVudD4ge1xuICBjb25zdCB7IHVybDogcGF0aCA9ICcnLCBtZXRob2QgfSA9IHJlcVxuICBjb25zdCB7IGhlYWRlcnMsIG11bHRpVmFsdWVIZWFkZXJzIH0gPSBub3JtYWxpemVSZXF1ZXN0SGVhZGVycyhyZXEuaGVhZGVycylcbiAgY29uc3QgaXNCYXNlNjRFbmNvZGVkID0gaXNCYXNlNjRFbmNvZGVkQ29udGVudFR5cGUoaGVhZGVyc1snY29udGVudC10eXBlJ10gfHwgJycpXG4gIGNvbnN0IGNvbnRlbnRMZW5ndGhIZWFkZXIgPSBoZWFkZXJzWydjb250ZW50LWxlbmd0aCddXG4gIGNvbnN0IGJvZHkgPSBjb250ZW50TGVuZ3RoSGVhZGVyXG4gICAgPyBhd2FpdCByYXdCb2R5KHJlcSwge1xuICAgICAgICBsaW1pdDogJzFtYicsXG4gICAgICAgIGVuY29kaW5nOiBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA/IG1pbWUuY2hhcnNldChoZWFkZXJzWydjb250ZW50LXR5cGUnXSkgfHwgdHJ1ZSA6IHRydWUsXG4gICAgICB9KVxuICAgIDogdW5kZWZpbmVkXG4gIGNvbnN0IHJhd1F1ZXJ5ID0gcGFyc2VVcmwocGF0aCkucXVlcnkgfHwgJydcbiAgY29uc3QgeyBxdWVyeVN0cmluZ1BhcmFtZXRlcnMsIG11bHRpVmFsdWVRdWVyeVN0cmluZ1BhcmFtZXRlcnMgfSA9IHBhcnNlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzKHJhd1F1ZXJ5KVxuXG4gIHJldHVybiBub3JtYWxpemVFdmVudCh7XG4gICAgcmF3VXJsOiBwYXRoLFxuICAgIHBhdGgsXG4gICAgaHR0cE1ldGhvZDogbWV0aG9kIGFzIHN0cmluZyxcbiAgICBoZWFkZXJzLFxuICAgIG11bHRpVmFsdWVIZWFkZXJzLFxuICAgIHJhd1F1ZXJ5LFxuICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVycyxcbiAgICBtdWx0aVZhbHVlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzLFxuICAgIGJvZHk6IGJvZHkgPyBCdWZmZXIuZnJvbShib2R5KS50b1N0cmluZyhpc0Jhc2U2NEVuY29kZWQgPyAnYmFzZTY0JyA6ICd1dGY4JykgOiBudWxsLFxuICAgIGlzQmFzZTY0RW5jb2RlZCxcbiAgICBwYXRoUGFyYW1ldGVyczogdW5kZWZpbmVkLFxuICAgIHJlcXVlc3RDb250ZXh0OiB7fSxcbiAgICByZXNvdXJjZTogJycsXG4gIH0pXG59XG4iLCAiaW1wb3J0IHsgcGFyc2UgYXMgcGFyc2VRdWVyeSB9IGZyb20gJ3F1ZXJ5LXN0cmluZydcbmltcG9ydCB7IFBhcmFtcywgTXVsdGlWYWx1ZVBhcmFtcyB9IGZyb20gJ2xhbWJkYS10eXBlcydcblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzKHF1ZXJ5OiBzdHJpbmcpIHtcbiAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeShxdWVyeSwgeyBhcnJheUZvcm1hdDogJ2NvbW1hJyB9KVxuXG4gIGNvbnN0IHF1ZXJ5U3RyaW5nUGFyYW1ldGVyczogUGFyYW1zID0ge31cbiAgY29uc3QgbXVsdGlWYWx1ZVF1ZXJ5U3RyaW5nUGFyYW1ldGVyczogTXVsdGlWYWx1ZVBhcmFtcyA9IHt9XG5cbiAgZm9yIChjb25zdCBwYXJhbSBvZiBPYmplY3Qua2V5cyhwYXJhbXMpKSB7XG4gICAgY29uc3QgdmFsdWUgPSBwYXJhbXNbcGFyYW1dXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICBtdWx0aVZhbHVlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzW3BhcmFtXSA9IHZhbHVlXG4gICAgfSBlbHNlIGlmICh2YWx1ZSkge1xuICAgICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzW3BhcmFtXSA9IHZhbHVlXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzLCBtdWx0aVZhbHVlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzIH1cbn1cbiIsICIvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9uZXRsaWZ5L2NsaS9ibG9iLzI3YmI3YjliMzBkNDY1YWJlODZmODdmNDI3NGRkN2E3MWIxYjAwM2Ivc3JjL3V0aWxzL3NlcnZlLWZ1bmN0aW9ucy5qcyNMMTY3XG5jb25zdCBCQVNFXzY0X01JTUVfUkVHRVhQID0gL2ltYWdlfGF1ZGlvfHZpZGVvfGFwcGxpY2F0aW9uXFwvcGRmfGFwcGxpY2F0aW9uXFwvemlwfGFwcGxpY2F0b25cXC9vY3RldC1zdHJlYW0vaVxuXG5leHBvcnQgZnVuY3Rpb24gaXNCYXNlNjRFbmNvZGVkQ29udGVudFR5cGUoY29udGVudFR5cGU6IHN0cmluZykge1xuICByZXR1cm4gQm9vbGVhbihjb250ZW50VHlwZSkgJiYgQkFTRV82NF9NSU1FX1JFR0VYUC50ZXN0KGNvbnRlbnRUeXBlKVxufVxuIiwgImltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzIH0gZnJvbSAnLi9wYXJzZVF1ZXJ5U3RyaW5nUGFyYW1ldGVycydcbmltcG9ydCB7IGlzQmFzZTY0RW5jb2RlZENvbnRlbnRUeXBlIH0gZnJvbSAnLi9pc0Jhc2U2NEVuY29kZWRDb250ZW50VHlwZSdcbmltcG9ydCB7IEV2ZW50IH0gZnJvbSAnLi4vJ1xuXG4vKipcbiAqIFRha2VzIGEgYFBhcnRpYWw8RXZlbnQ+YCBhbmQgcmV0dXJucyBgRXZlbnRgLiBSZXF1aXJlcyBhdCBsZWFzdCBhbiBgZXZlbnQucGF0aGAgcHJvcGVydHkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVFdmVudChldmVudDogUGljazxFdmVudCwgJ3BhdGgnPiAmIFBhcnRpYWw8T21pdDxFdmVudCwgJ3BhdGgnPj4pOiBFdmVudCB7XG4gIGNvbnN0IHJhd1F1ZXJ5ID0gZXZlbnQucmF3UXVlcnkgfHwgZXZlbnQucGF0aC5zcGxpdCgnPycpWzFdXG4gIGNvbnN0IHsgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzLCBtdWx0aVZhbHVlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzIH0gPSBwYXJzZVF1ZXJ5U3RyaW5nUGFyYW1ldGVycyhyYXdRdWVyeSlcbiAgY29uc3QgaXNCYXNlNjRFbmNvZGVkID0gZXZlbnQuaXNCYXNlNjRFbmNvZGVkID8/IGlzQmFzZTY0RW5jb2RlZENvbnRlbnRUeXBlKGV2ZW50Py5oZWFkZXJzPy5bJ2NvbnRlbnQtdHlwZSddIHx8ICcnKVxuXG4gIHJldHVybiB7XG4gICAgcmF3VXJsOiBldmVudC5yYXdVcmwgfHwgZXZlbnQucGF0aCxcbiAgICByYXdRdWVyeSxcbiAgICBwYXRoOiBldmVudC5wYXRoLFxuICAgIGh0dHBNZXRob2Q6IGV2ZW50Lmh0dHBNZXRob2QgfHwgJ0dFVCcsXG4gICAgaGVhZGVyczogZXZlbnQuaGVhZGVycyB8fCB7fSxcbiAgICBtdWx0aVZhbHVlSGVhZGVyczogZXZlbnQubXVsdGlWYWx1ZUhlYWRlcnMgfHwge30sXG4gICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiBldmVudC5xdWVyeVN0cmluZ1BhcmFtZXRlcnMgfHwgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzLFxuICAgIG11bHRpVmFsdWVRdWVyeVN0cmluZ1BhcmFtZXRlcnM6IGV2ZW50Lm11bHRpVmFsdWVRdWVyeVN0cmluZ1BhcmFtZXRlcnMgfHwgbXVsdGlWYWx1ZVF1ZXJ5U3RyaW5nUGFyYW1ldGVycyxcbiAgICBwYXRoUGFyYW1ldGVyczogZXZlbnQucGF0aFBhcmFtZXRlcnMgfHwge30sXG4gICAgYm9keTogZXZlbnQuYm9keSB8fCBudWxsLFxuICAgIGlzQmFzZTY0RW5jb2RlZDogaXNCYXNlNjRFbmNvZGVkID8/IGZhbHNlLFxuICAgIHJlcXVlc3RDb250ZXh0OiBldmVudC5yZXF1ZXN0Q29udGV4dCB8fCB7fSxcbiAgICByZXNvdXJjZTogZXZlbnQucmVzb3VyY2UgfHwgJycsXG4gIH1cbn1cbiIsICJpbXBvcnQgdHlwZSBodHRwIGZyb20gJ2h0dHAnXG5pbXBvcnQgeyBQYXJhbXMsIE11bHRpVmFsdWVQYXJhbXMgfSBmcm9tICdsYW1iZGEtdHlwZXMnXG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVSZXF1ZXN0SGVhZGVycyhyYXdSZXF1ZXN0SGVhZGVyczogaHR0cC5JbmNvbWluZ01lc3NhZ2VbJ2hlYWRlcnMnXSkge1xuICBjb25zdCBoZWFkZXJzOiBQYXJhbXMgPSB7fVxuICBjb25zdCBtdWx0aVZhbHVlSGVhZGVyczogTXVsdGlWYWx1ZVBhcmFtcyA9IHt9XG5cbiAgZm9yIChjb25zdCBoZWFkZXIgb2YgT2JqZWN0LmtleXMocmF3UmVxdWVzdEhlYWRlcnMpKSB7XG4gICAgY29uc3Qga2V5ID0gaGVhZGVyLnRvTG93ZXJDYXNlKClcbiAgICBjb25zdCB2YWx1ZSA9IHJhd1JlcXVlc3RIZWFkZXJzW2hlYWRlcl1cblxuICAgIGlmICghdmFsdWUpIGNvbnRpbnVlXG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIG11bHRpVmFsdWVIZWFkZXJzW2tleV0gPSB2YWx1ZVxuICAgIH0gZWxzZSB7XG4gICAgICBoZWFkZXJzW2tleV0gPSB2YWx1ZVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IGhlYWRlcnMsIG11bHRpVmFsdWVIZWFkZXJzIH1cbn1cbiIsICJpbXBvcnQgc3RhdHVzIGZyb20gJ3N0YXR1c2VzJ1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEh0bWxSZXNwb25zZSh7IHN0YXR1c0NvZGUgfTogeyBzdGF0dXNDb2RlOiBudW1iZXIgfSkge1xuICByZXR1cm4gYDwhLS0gYnVpbHQgd2l0aCBwcmVzdGEgaHR0cHM6Ly9ucG0uaW0vcHJlc3RhIC0tPlxuICAgIDwhRE9DVFlQRSBodG1sPlxuICAgIDxodG1sPlxuICAgICAgPGhlYWQ+XG4gICAgICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiIC8+XG4gICAgICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsaW5pdGlhbC1zY2FsZT0xXCIgLz5cbiAgICAgICAgPHRpdGxlPiR7c3RhdHVzQ29kZX0gXHUyMDE0XHUwMEEwJHtzdGF0dXMubWVzc2FnZVtzdGF0dXNDb2RlXX08L3RpdGxlPlxuICAgICAgICA8bGluayByZWw9XCJpY29uXCIgdHlwZT1cImltYWdlL3BuZ1wiIGhyZWY9XCJodHRwczovL3ByZXN0YS5ydW4vZmF2aWNvbi5wbmdcIj5cbiAgICAgICAgPGxpbmsgcmVsPVwiaWNvblwiIHR5cGU9XCJpbWFnZS9zdmdcIiBocmVmPVwiaHR0cHM6Ly9wcmVzdGEucnVuL2Zhdmljb24uc3ZnXCI+XG4gICAgICAgIDxsaW5rIHJlbD1cInByZWNvbm5lY3RcIiBocmVmPVwiaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbVwiPlxuICAgICAgICA8bGluayByZWw9XCJwcmVjb25uZWN0XCIgaHJlZj1cImh0dHBzOi8vZm9udHMuZ3N0YXRpYy5jb21cIiBjcm9zc29yaWdpbj5cbiAgICAgICAgPGxpbmsgaHJlZj1cImh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9SW50ZXI6d2dodEA0MDA7OTAwJmRpc3BsYXk9c3dhcFwiIHJlbD1cInN0eWxlc2hlZXRcIj4gXG4gICAgICAgIDxsaW5rIHJlbD0nc3R5bGVzaGVldCcgaHJlZj0naHR0cHM6Ly91bnBrZy5jb20vc3Zic3RyYXRlQDUuMS4wL3N2YnN0cmF0ZS5jc3MnIC8+XG4gICAgICAgIDxzdHlsZT5cbiAgICAgICAgICBodG1sLGJvZHkge1xuICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdJbnRlcicsICdzYW5zLXNlcmlmJztcbiAgICAgICAgICAgIGNvbG9yOiAjMjMyODNEO1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0RBREVGMDtcbiAgICAgICAgICB9XG4gICAgICAgICAgI2Zhdmljb24ge1xuICAgICAgICAgICAgZmlsbDogIzIzMjgzRDtcbiAgICAgICAgICB9XG4gICAgICAgICAgQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykge1xuICAgICAgICAgICAgaHRtbCxib2R5IHtcbiAgICAgICAgICAgICAgY29sb3I6ICNEQURFRjA7XG4gICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMyMzI4M0Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAjZmF2aWNvbiB7XG4gICAgICAgICAgICAgIGZpbGw6ICNEQURFRjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgPC9oZWFkPlxuICAgICAgPGJvZHkgY2xhc3M9J3cgZiBhaWMgamNjJyBzdHlsZT0naGVpZ2h0OiAxMDB2aCc+XG4gICAgICAgIDxkaXYgY2xhc3M9J3AxMiB0YWMnPlxuICAgICAgICAgIDxoMT4ke3N0YXR1c0NvZGV9PC9oMT5cbiAgICAgICAgICA8cCBjbGFzcz0nbWIxJz4ke3N0YXR1cy5tZXNzYWdlW3N0YXR1c0NvZGVdfTwvcD5cblxuICAgICAgICAgIDxzdmcgd2lkdGg9XCIzMlwiIGhlaWdodD1cIjMyXCIgdmlld0JveD1cIjAgMCAzMiAzMlwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICAgICAgICAgICAgPGcgY2xpcC1wYXRoPVwidXJsKCNhKVwiPlxuICAgICAgICAgICAgICA8cGF0aCBpZD1cImZhdmljb25cIiBmaWxsLXJ1bGU9XCJldmVub2RkXCIgY2xpcC1ydWxlPVwiZXZlbm9kZFwiIGQ9XCJNMTAuNCA3Yy0uMyAwLS44LjItMSAuNUwxLjEgMjIuMWMtLjIuMyAwIC42LjMuNmw0IC4zLTIuMSAyLjZjLS4yLjMtLjEuNi4yLjZsMTYuOCAxLjNjLjQgMCAuOC0uMiAxLS40TDMyIDEzLjljLjItLjIuMS0uNS0uMi0uNWwtNi40LS41IDIuMi00Yy4yLS4zIDAtLjUtLjMtLjZMMTAuNCA3Wk0yNCAxMi44bDEuOS0zLjQtMTUuNS0xLjItNy43IDEzLjQgMy42LjMgNy41LTkuNGMuMy0uMy43LS41IDEtLjRsOS4yLjdaTTcuNiAyMmw3LjEtOC45IDguNy43LTUuMiA5TDcuNiAyMlptLTEgMS4xIDExLjYgMWMuMyAwIC44LS4zIDEtLjZsNS41LTkuNiA1LjUuNS05LjcgMTJMNSAyNS4ybDEuNy0yWlwiIGZpbGw9XCIjMjMyODNEXCIvPlxuICAgICAgICAgICAgPC9nPlxuICAgICAgICAgICAgPGRlZnM+XG4gICAgICAgICAgICAgIDxjbGlwUGF0aCBpZD1cImFcIj5cbiAgICAgICAgICAgICAgICA8cGF0aCBmaWxsPVwiI2ZmZlwiIGQ9XCJNMCAwaDMydjMySDB6XCIvPlxuICAgICAgICAgICAgICA8L2NsaXBQYXRoPlxuICAgICAgICAgICAgPC9kZWZzPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvYm9keT5cbiAgICA8L2h0bWw+XG4gIGBcbn1cbiIsICJpbXBvcnQgdG9SZWdFeHAgZnJvbSAncmVnZXhwYXJhbSdcbmltcG9ydCB7IFBhcmFtcyB9IGZyb20gJ2xhbWJkYS10eXBlcydcblxuLy8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vbHVrZWVkL3JlZ2V4cGFyYW0jdXNhZ2VcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVBhdGhQYXJhbWV0ZXJzKHVybDogc3RyaW5nLCByb3V0ZTogc3RyaW5nKTogUGFyYW1zIHtcbiAgY29uc3QgW3BhdGhdID0gdXJsLnNwbGl0KCc/JylcbiAgY29uc3QgcmVzdWx0ID0gdG9SZWdFeHAocm91dGUpXG4gIGxldCBpID0gMFxuICBsZXQgb3V0OiBQYXJhbXMgPSB7fVxuICBsZXQgbWF0Y2hlcyA9IHJlc3VsdC5wYXR0ZXJuLmV4ZWMocGF0aCkgfHwgW11cblxuICB3aGlsZSAoaSA8IHJlc3VsdC5rZXlzLmxlbmd0aCkge1xuICAgIG91dFtyZXN1bHQua2V5c1tpXV0gPSBtYXRjaGVzWysraV1cbiAgfVxuXG4gIHJldHVybiBvdXRcbn1cbiIsICJpbXBvcnQgdHlwZSBodHRwIGZyb20gJ2h0dHAnXG5pbXBvcnQgdHlwZSB7IFJlc3BvbnNlIH0gZnJvbSAnbGFtYmRhLXR5cGVzJ1xuXG5leHBvcnQgZnVuY3Rpb24gc2VuZFNlcnZlcmxlc3NSZXNwb25zZShyZXM6IGh0dHAuU2VydmVyUmVzcG9uc2UsIHJlc3BvbnNlOiBSZXNwb25zZSkge1xuICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9uZXRsaWZ5L2NsaS9ibG9iLzI3YmI3YjliMzBkNDY1YWJlODZmODdmNDI3NGRkN2E3MWIxYjAwM2Ivc3JjL3V0aWxzL3NlcnZlLWZ1bmN0aW9ucy5qcyNMNzNcbiAgaWYgKHJlc3BvbnNlLm11bHRpVmFsdWVIZWFkZXJzKSB7XG4gICAgZm9yIChjb25zdCBoZWFkZXIgb2YgT2JqZWN0LmtleXMocmVzcG9uc2UubXVsdGlWYWx1ZUhlYWRlcnMpKSB7XG4gICAgICByZXMuc2V0SGVhZGVyKFxuICAgICAgICBoZWFkZXIsXG4gICAgICAgIHJlc3BvbnNlLm11bHRpVmFsdWVIZWFkZXJzW2hlYWRlcl0ubWFwKCh2KSA9PiBTdHJpbmcodikpXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgaWYgKHJlc3BvbnNlLmhlYWRlcnMpIHtcbiAgICBmb3IgKGNvbnN0IGhlYWRlciBvZiBPYmplY3Qua2V5cyhyZXNwb25zZS5oZWFkZXJzKSkge1xuICAgICAgcmVzLnNldEhlYWRlcihoZWFkZXIsIFN0cmluZyhyZXNwb25zZS5oZWFkZXJzW2hlYWRlcl0pKVxuICAgIH1cbiAgfVxuXG4gIHJlcy5zdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzQ29kZVxuICByZXMuZW5kKHJlc3BvbnNlLmJvZHkpXG59XG4iLCAiaW1wb3J0IHsgUGFyYW1zIH0gZnJvbSAnbGFtYmRhLXR5cGVzJ1xuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplUmVzcG9uc2VIZWFkZXJzPFQgPSBQYXJhbXM+KHJlc3BvbnNlSGVhZGVyczogVCk6IFQge1xuICAvLyBAdHMtaWdub3JlXG4gIGZvciAoY29uc3QgaGVhZGVyIG9mIE9iamVjdC5rZXlzKHJlc3BvbnNlSGVhZGVycykpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcmVzcG9uc2VIZWFkZXJzW2hlYWRlci50b0xvd2VyQ2FzZSgpXSA9IHJlc3BvbnNlSGVhZGVyc1toZWFkZXJdIHx8ICcnXG4gIH1cblxuICByZXR1cm4gcmVzcG9uc2VIZWFkZXJzXG59XG4iLCAiLyoqXG4gKiBUaGlzIGlzIHByb2R1Y3Rpb24gY29kZSwgc28gYmUgY2FyZWZ1bCB3aGF0IHlvdSBhZGQgdG8gdGhpcyBmaWxlIGJlY2F1c2Ugd2VcbiAqIHdhbnQgdG8ga2VlcCBpdCBzbWFsbC5cbiAqXG4gKiBUaGlzIGZpbGUgaXMgdXNlZCBpbiBjb21waWxlZCBQcmVzdGEgZnVuY3Rpb25zIHRvIHNlcmlhbGl6ZSBvdXRwdXQuXG4gKi9cbmltcG9ydCB7IFJlc3BvbnNlIGFzIExhbWJkYVJlc3BvbnNlIH0gZnJvbSAnbGFtYmRhLXR5cGVzJ1xuaW1wb3J0IHsgbm9ybWFsaXplUmVzcG9uc2VIZWFkZXJzIH0gZnJvbSAnLi9ydW50aW1lL25vcm1hbGl6ZVJlc3BvbnNlSGVhZGVycydcblxuaW1wb3J0IHsgUmVzcG9uc2UgfSBmcm9tICcuL2NvcmUnXG5cbmVudW0gQ29udGVudFR5cGUge1xuICBIdG1sID0gJ3RleHQvaHRtbDsgY2hhcnNldD11dGYtOCcsXG4gIEpzb24gPSAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXG4gIFhtbCA9ICdhcHBsaWNhdGlvbi94bWw7IGNoYXJzZXQ9dXRmLTgnLFxufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnlPYmplY3Qob2JqOiBvYmplY3QgfCBzdHJpbmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkob2JqKSA6IG9ialxufVxuXG5mdW5jdGlvbiBiYXNlKGNvbnRlbnRUeXBlOiBDb250ZW50VHlwZSwgcmVzcG9uc2U6IFBhcnRpYWw8UmVzcG9uc2U+KTogTGFtYmRhUmVzcG9uc2Uge1xuICBjb25zdCBzdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzQ29kZSB8fCAyMDBcbiAgY29uc3Qgbm9ybWFsaXplZEhlYWRlcnMgPSByZXNwb25zZS5oZWFkZXJzID8gbm9ybWFsaXplUmVzcG9uc2VIZWFkZXJzKHJlc3BvbnNlLmhlYWRlcnMpIDoge31cbiAgY29uc3QgcmVkaXIgPSBzdGF0dXNDb2RlID4gMjk5ICYmIHN0YXR1c0NvZGUgPCAzOTlcblxuICBpZiAoIXJlZGlyKSB7XG4gICAgbm9ybWFsaXplZEhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gY29udGVudFR5cGVcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaXNCYXNlNjRFbmNvZGVkOiByZXNwb25zZS5pc0Jhc2U2NEVuY29kZWQgfHwgZmFsc2UsXG4gICAgc3RhdHVzQ29kZSxcbiAgICBoZWFkZXJzOiBub3JtYWxpemVkSGVhZGVycyxcbiAgICBtdWx0aVZhbHVlSGVhZGVyczogcmVzcG9uc2UubXVsdGlWYWx1ZUhlYWRlcnMgPyBub3JtYWxpemVSZXNwb25zZUhlYWRlcnMocmVzcG9uc2UubXVsdGlWYWx1ZUhlYWRlcnMpIDoge30sXG4gICAgYm9keTogc3RyaW5naWZ5T2JqZWN0KHJlc3BvbnNlLmJvZHkgfHwgJycpLFxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBodG1sKHJlc3BvbnNlOiBQYXJ0aWFsPFJlc3BvbnNlPik6IExhbWJkYVJlc3BvbnNlIHtcbiAgcmV0dXJuIGJhc2UoQ29udGVudFR5cGUuSHRtbCwgcmVzcG9uc2UpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBqc29uKHJlc3BvbnNlOiBPbWl0PFBhcnRpYWw8UmVzcG9uc2U+LCAnYm9keSc+ICYgeyBib2R5OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB9KTogTGFtYmRhUmVzcG9uc2Uge1xuICByZXR1cm4gYmFzZShDb250ZW50VHlwZS5Kc29uLCB7IC4uLnJlc3BvbnNlLCBib2R5OiBzdHJpbmdpZnlPYmplY3QocmVzcG9uc2UuYm9keSkgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHhtbChyZXNwb25zZTogUGFydGlhbDxSZXNwb25zZT4pOiBMYW1iZGFSZXNwb25zZSB7XG4gIHJldHVybiBiYXNlKENvbnRlbnRUeXBlLlhtbCwgcmVzcG9uc2UpXG59XG4iLCAiaW1wb3J0IHsgUmVzcG9uc2UgYXMgTGFtYmRhUmVzcG9uc2UgfSBmcm9tICdsYW1iZGEtdHlwZXMnXG5cbmltcG9ydCB7IGh0bWwgfSBmcm9tICcuLi9zZXJpYWxpemUnXG5pbXBvcnQgdHlwZSB7IFJlc3BvbnNlIH0gZnJvbSAnLi4vY29yZSdcblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVJlc3BvbnNlKHJlc3BvbnNlOiBSZXNwb25zZSB8IHN0cmluZyk6IExhbWJkYVJlc3BvbnNlIHtcbiAgcmV0dXJuIHR5cGVvZiByZXNwb25zZSA9PT0gJ3N0cmluZydcbiAgICA/IGh0bWwoeyBib2R5OiByZXNwb25zZSB9KVxuICAgIDoge1xuICAgICAgICAuLi5yZXNwb25zZSxcbiAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzQ29kZSB8fCAyMDAsXG4gICAgICB9XG59XG4iLCAiaW1wb3J0IHsgUmVzcG9uc2UgYXMgTGFtYmRhUmVzcG9uc2UgfSBmcm9tICdsYW1iZGEtdHlwZXMnXG5cbmltcG9ydCB7IG5vcm1hbGl6ZUV2ZW50IH0gZnJvbSAnLi9ub3JtYWxpemVFdmVudCdcbmltcG9ydCB7IHBhcnNlUGF0aFBhcmFtZXRlcnMgfSBmcm9tICcuL3BhcnNlUGF0aFBhcmFtZXRlcnMnXG5pbXBvcnQgeyBub3JtYWxpemVSZXNwb25zZSB9IGZyb20gJy4vbm9ybWFsaXplUmVzcG9uc2UnXG5cbmltcG9ydCB0eXBlIHsgUHJlc3RhRnVuY3Rpb25GaWxlLCBFdmVudCwgQ29udGV4dCB9IGZyb20gJy4uL2NvcmUnXG5cbi8qKlxuICogVGhpcyBmdW5jdGlvbiB3cmFwcyBldmVyeSBQcmVzdGEgaGFuZGxlci4gUGx1Z2lucyB3cmFwIGFyb3VuZCB0aGlzLCBzbyBrZWVwXG4gKiBpbiBtaW5kIHRoYXQgc29tZSB3b3JrIGlzIGRvbmUgaGVyZSBhbHJlYWR5IGFuZCBkb2Vzbid0IG5lZWQgdG8gYmVcbiAqIGR1cGxpY2F0ZWQgaW4gb3RoZXIgYWRhcHRlcnMgYW5kIHBsdWdpbnMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3cmFwSGFuZGxlcihmaWxlOiBQcmVzdGFGdW5jdGlvbkZpbGUpOiAoZXZlbnQ6IEV2ZW50LCBjb250ZXh0OiBDb250ZXh0KSA9PiBQcm9taXNlPExhbWJkYVJlc3BvbnNlPiB7XG4gIHJldHVybiBhc3luYyAoZXZlbnQ6IEV2ZW50LCBjb250ZXh0OiBDb250ZXh0KSA9PiB7XG4gICAgY29uc3QgZXYgPSBub3JtYWxpemVFdmVudChldmVudClcblxuICAgIGlmICghT2JqZWN0LmtleXMoZXYucGF0aFBhcmFtZXRlcnMgfHwge30pLmxlbmd0aCkge1xuICAgICAgZXYucGF0aFBhcmFtZXRlcnMgPSBwYXJzZVBhdGhQYXJhbWV0ZXJzKGV2ZW50LnBhdGgsIGZpbGUucm91dGUpXG4gICAgfVxuXG4gICAgcmV0dXJuIG5vcm1hbGl6ZVJlc3BvbnNlKGF3YWl0IGZpbGUuaGFuZGxlcihldiwgY29udGV4dCkpXG4gIH1cbn1cbiIsICIvKipcbiAqIFRoaXMgaXMgbWFpbiBleHBvcnQgb2YgdGhlIFByZXN0YSBsaWJyYXJ5LiBJdCdzIHVzZWQgYnkgbW9zdCBlbmQtdXNlcnNcbiAqIHdpdGhpbiB0aGVpciBhcHBsaWNhdGlvbnMsIHNvIHdlIG5lZWQgdG8ga2VlcCBpdCBhcyBzbWFsbCBhcyBwb3NzaWJsZS4gSXRcbiAqIHNob3VsZCBtb3N0bHktcmUtZXhwb3J0IHR5cGVzIGFuZCB1dGlscyBmb3IgZW5kLXVzZXIgdXNlLlxuICovXG5pbXBvcnQgdHlwZSB7IFByZXN0YUNvbmZpZywgSGFuZGxlciwgUGx1Z2luIH0gZnJvbSAnLi9jb3JlJ1xuXG5leHBvcnQgdHlwZSBDb25maWcgPSBQcmVzdGFDb25maWdcblxuZXhwb3J0IHR5cGUge1xuICBFdmVudCxcbiAgQ29udGV4dCxcbiAgSGFuZGxlcixcbiAgUmVzcG9uc2UsXG4gIEhlYWRlcnMsXG4gIFBsdWdpbixcbiAgUGx1Z2luQ29udGV4dCxcbiAgUGx1Z2luSW50ZXJmYWNlLFxuICBNYW5pZmVzdCxcbn0gZnJvbSAnLi9jb3JlJ1xuXG5leHBvcnQgZW51bSBNb2RlIHtcbiAgRGV2ID0gJ2RldicsXG4gIEJ1aWxkID0gJ2J1aWxkJyxcbiAgU2VydmUgPSAnc2VydmUnLFxufVxuXG5leHBvcnQgY2xhc3MgSHR0cEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBzdGF0dXNDb2RlOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcsIHN0YXR1c0NvZGU6IG51bWJlciA9IDUwMCkge1xuICAgIHN1cGVyKG1lc3NhZ2UpXG5cbiAgICB0aGlzLm5hbWUgPSAnSHR0cEVycm9yJ1xuICAgIHRoaXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGVcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlQ29uZmlnID0gKGNvbmY6IFBhcnRpYWw8Q29uZmlnPikgPT4gY29uZlxuZXhwb3J0IGNvbnN0IGNyZWF0ZVBsdWdpbiA9IDxUPihmbjogKG9wdGlvbnM6IFQpID0+IFBsdWdpbikgPT4gZm5cbmV4cG9ydCBjb25zdCBjcmVhdGVSb3V0ZSA9IChyb3V0ZTogc3RyaW5nKSA9PiByb3V0ZVxuZXhwb3J0IGNvbnN0IGNyZWF0ZUdldFN0YXRpY1BhdGhzID0gKGdldFN0YXRpY1BhdGhzOiAoKSA9PiBzdHJpbmdbXSkgPT4gZ2V0U3RhdGljUGF0aHNcbmV4cG9ydCBjb25zdCBjcmVhdGVIYW5kbGVyID0gKGhhbmRsZXI6IEhhbmRsZXIpID0+IGhhbmRsZXJcbiJdLAogICJtYXBwaW5ncyI6ICI7eTNCQUVBLE9BQWlCLG1CQUNqQixHQUFvQztxOUNDRnBDLE9BQWlCLG1CQUNqQixHQUFxQix5QkFD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LENBQUUsaUJBR3hDLEtBQUssT0FBTyxNQUFNLEdBQ2xCLEtBQUssT0FBTyxNQUFNLGVBQUssRUFBTSxRQUFRLEVBQVMsYUFBYyxDQUFFLFNBQVUsTUFFeEUsRUFBdUIsRUFBSyxNRHJqQ2xDLGtCQUVBLEdBQU0sR0FBVSxlQUFLLFVBRXJCLEVBQ0csUUFBUSxFQUFJLFNBRVosT0FBTyxlQUFnQixvQ0FBb0MsTUFDM0QsT0FBTyxvQkFBcUIsaUZBQzVCLE9BQ0MsdUJBQ0EsNEZBRUQsT0FBTyxlQUFnQix1REFDdkIsT0FBTyxjQUFlLHdDQUN0QixRQUFRLHlCQUNSLFFBQVEsK0JBQ1IsUUFBUSxpQkFDUixRQUFRLGdCQUNSLFFBQVEsaUJBRVgsRUFDRyxRQUFRLFFBQVMscUNBQXNDLENBQUUsUUFBUyxLQUNsRSxRQUFRLElBQ1IsUUFBUSxpQkFDUixRQUFRLE1BQU0sS0FDZCxPQUFPLEtBQU8sSUFBMkIsQ0FDeEMsUUFBUSxJQUFJLFdBQWEsYUFDekIsUUFBUSxJQUFJLGFBQWUsRUFBUSxNQUFRLFFBQVUsR0FDckQsUUFBUSxRQUNSLEdBQU0sR0FBUyxFQUFZLEVBQXVCLEVBQVEsUUFBUyxHQUNuRSxLQUFNLElBQUksR0FBTyxHQUFRLFVBRzdCLEVBQ0csUUFBUSxNQUFPLDBDQUEyQyxDQUFFLE1BQU8sVUFDbkUsT0FBTyxhQUFjLGlEQUNyQixPQUFPLGNBQWUseUNBQ3RCLFNBQVMsZ0RBQ1QsUUFBUSxPQUNSLFFBQVEsdUJBQ1IsUUFBUSxnQ0FDUixRQUFRLFVBQVUsS0FDbEIsT0FBTyxLQUFPLElBQTJCLENBQ3hDLFFBQVEsSUFBSSxXQUFhLGNBQ3pCLFFBQVEsSUFBSSxhQUFlLEVBQVEsTUFBUSxRQUFVLEdBQ3JELFFBQVEsUUFDUixHQUFNLEdBQVMsRUFBWSxFQUF1QixFQUFRLFFBQVMsR0FDbkUsR0FBSSxHQUFPLEdBQVEsUUFHdkIsRUFDRyxRQUFRLFNBQ1IsT0FBTyxhQUFjLGlEQUNyQixTQUFTLGtEQUNULFFBQVEsU0FDUixRQUFRLDBCQUNSLFFBQVEsWUFBWSxLQUNwQixPQUFPLEtBQU8sSUFBMkIsQ0FDeEMsUUFBUSxJQUFJLFdBQWEsY0FDekIsUUFBUSxJQUFJLGFBQWUsRUFBUSxNQUFRLFFBQVUsR0FDckQsUUFBUSxRQUNSLEdBQU0sR0FBUyxFQUFZLEVBQXVCLEVBQVEsUUFBUyxHQUNuRSxHQUFJLEdBQU8sR0FBUSxVQUd2QixFQUFRLE1BQU0sUUFBUSIsCiAgIm5hbWVzIjogW10KfQo=
